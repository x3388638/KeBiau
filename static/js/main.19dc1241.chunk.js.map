{"version":3,"sources":["Navigation.jsx","App.jsx","Loading.jsx","CourseList.jsx","CourseGrid.jsx","CourseTable.jsx","ToolBar.jsx","CourseTableContainer.jsx","Home.jsx","ExchangeSetting.jsx","ExchangeItem.jsx","ExchangeList.jsx","ExchangeListContainer.jsx","Exchange.jsx","Share.jsx","CourseReviewFilter.jsx","CourseReviewList.jsx","CourseReviewContainer.jsx","CourseReview.jsx","registerServiceWorker.js","index.js"],"names":["NavigationBar","styled","Navbar","Hide850","span","UserImg","img","UserName","Navigation","props","toggleNavbar","bind","toggleLoginTooltip","toggleLogoutTooltip","state","navbarIsOpen","loginTooltip","logoutTooltip","this","setState","prevState","provider","window","firebase","auth","FacebookAuthProvider","signInWithPopup","then","result","token","credential","accessToken","fbid","user","providerData","uid","fetch","res","json","location","reload","catch","error","errorCode","code","errorMessage","message","console","signOut","route","context","router","loginStatusInit","isLogin","color","dark","expand","href","process","src","alt","height","onClick","isOpen","navbar","className","match","path","to","aria-hidden","target","fbLink","displayName","id","handleLogout","delay","show","hide","placement","toggle","handleLogin","React","Component","contextTypes","PropTypes","object","RelativeContainer","Container","App","db","database","onAuthStateChanged","Object","assign","uuid","children","childContextTypes","LoadingWrapper","div","marginTop","Loading","loading","width","PureComponent","CommonRow","TableHeader","TableRow","DeptSelector","selected","handleSelect","e","value","onChangeDept","onChange","keys","deptList","map","val","i","key","filterCourse","size","onFilterCourse","filterConflict","onFilterConflict","rel","CourseList","list","courseList","style","overflow","maxHeight","background","length","Fragment","isConflict","data-uuid","cid","cname","classes","time","teacher","grade","year","disabled","onAddCourse","EditBtnContainer","DelBtn","EditBtn","Grid","td","bg","hex","exec","r","parseInt","g","b","_hexToRgb","Math","sqrt","CourseGrid","mouseEnter","handleMouseEnter","handleMouseLeave","handleDel","handleEdit","shared","parentNode","getAttribute","rowspan","onDelCourse","dayOfWeek","onEditCourse","title","desc","rowSpan","onMouseEnter","onMouseLeave","WeekendTitle","th","CourseTable","classArr","document","getElementById","replace","trim","split","join","setTimeout","bordered","responsive","tableLayout","tableData","sat","onDelSatOrSun","sun","t","data-time","course","courseData","ToolBar","exportDropdownOpen","clearDropdownOpen","toggleExportDropdown","toggleClearDropdown","querySelectorAll","forEach","setAttribute","html","innerHTML","open","encodeURIComponent","preventDefault","html2canvas","onrendered","canvas","Canvas2Image","saveAsPNG","btnStyle","cursor","marginBottom","onSave","onShare","caret","handleExportExcel","handleExportPNG","onReColor","onReTable","onClickCustom","CourseTableContainer","customTable","0","1","2","3","4","5","6","modalEditCourse","modalTitle","modalCustomCourseOpen","modalFilterCourseOpen","filterCourseForm","timeMap","a","c","d","z","f","h","j","k","l","m","timeOrder","getCourseList","getCourseData","changeDept","getTableData","checkConflict","handleDelSatOrSun","handleDelCourse","handleOpenEditModal","toggleModalEditCourse","handleEditCourse","handleReColor","handleReTable","toggleModalCustomCourse","handleAddCustomCourse","handleSave","handleShare","toggleModalFilterCourse","handleFilterCourse","handleClearFilterCourse","handleFilterCourseChange","dept","sessionCourseList","sessionStorage","JSON","parse","ref","once","snapshot","stringify","shouldAddCourse","toLowerCase","sections","apartCourseTime","timeValid","some","valid","validateTime","alert","msg","conflict","cloneDeep","index","startTime","nextTimeOrder","indexOf","nextTime","nextTimeCourse","test","last","err","current","charCodeAt","push","day","dayOrder","set","hash","Date","now","random","toString","substring","prompt","event","field","isFilterCourse","parsedCourseList","reduce","courseKey","every","toUpperCase","includes","padding","boxShadow","xs","row","for","sm","type","defaultValue","placeholder","verticalAlign","Home","SettingContainer","top","Toggle","ExchangeSetting","wantTags","haveTags","filterTags","published","settingOpen","handleChangeWant","handleChangeHave","handleChangeDesc","handleChangeFilter","handleFilter","handleToggleSetting","nextProps","exchangeSetting","exchangeList","want","have","clear","keywords","onFilter","offsetHeight","body","onlyUnique","rows","onUnpublish","outline","Card","Profile","Username","Timestamp","Desc","CourseTitle","h6","Course","ExchangeItem","item","lg","name","moment","utcOffset","format","wnatCourse","pill","haveCourse","ExchangeList","transition","ExchangeListContainer","filter","handleSaveExchangeSetting","handleUnpublish","parseList","getExchangeList","data","localStorage","ReactAlert","warning","position","effect","beep","timeout","onClose","remove","cloenDeep","filterArr","values","shuffle","testString","keyword","array","temporaryValue","randomIndex","currentIndex","floor","onToggleSetting","Exchange","ShareContainer","Share","routeHash","params","CourseReviewFilter","sortType","onChangeSortType","ReviewCard","Title","Content","LikeBtn","like","css","DisLikeBtn","dislike","ReviewItem","currentUserLike","username","currentUserPost","onDel","content","display","onLike","CourseReviewList","reviewListBricks","destroy","Bricklayer","querySelector","reviewList","ThePen","ReviewListContainer","Row","CourseReviewContainer","addReviewModalOpen","reviewData","likeData","toggleAddReviewModal","handleAddReview","getReviewList","parseReviewList","handleChangeSortType","handleDelReview","handleLike","likedCount","likeObj","reviewKey","reviewObj","undefined","sort","compareByTime","compareByLike","isBefore","randomKey","confirm","btnType","block","CourseReview","isLocalhost","Boolean","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","ReactDOM","render","exact","component","from","URL","origin","addEventListener","response","status","headers","get","ready","unregister","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.19dc1241.chunk.js","sourcesContent":["import React from 'react';\nimport {\n\tCollapse,\n\tNavbar,\n\tNavbarToggler,\n\tNavbarBrand,\n\tNav,\n\tNavItem,\n\tNavLink,\n\tTooltip,\n} from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nconst NavigationBar = styled(Navbar)`\n\tz-index: 5;\n\tpadding: 0.3rem 1rem;\n`;\n\nconst Hide850 = styled.span`\n\t@media (max-width: 850px) and (min-width: 576px) {\n\t\tdisplay: none;\n\t}\n`;\n\nconst UserImg = styled.img`\n\tborder-radius: 50px;\n`;\n\nconst UserName = styled.span`\n\t@media (max-width: 1000px) and (min-width: 576px) {\n\t\tdisplay: none;\n\t}\n`;\n\nexport default class Navigation extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.toggleNavbar = this.toggleNavbar.bind(this);\n\t\tthis.toggleLoginTooltip = this.toggleLoginTooltip.bind(this);\n\t\tthis.toggleLogoutTooltip = this.toggleLogoutTooltip.bind(this);\n\t\tthis.state = {\n\t\t\tnavbarIsOpen: false,\n\t\t\tloginTooltip: false,\n\t\t\tlogoutTooltip: false,\n\t\t};\n\t}\n\n\ttoggleNavbar() {\n\t\tthis.setState((prevState) => ({\n\t\t\tnavbarIsOpen: !prevState.navbarIsOpen\n\t\t}));\n\t}\n\n\ttoggleLoginTooltip() {\n\t\tthis.setState((prevState) => ({\n\t\t\tloginTooltip: !prevState.loginTooltip\n\t\t}));\n\t}\n\n\ttoggleLogoutTooltip() {\n\t\tthis.setState((prevState) => ({\n\t\t\tlogoutTooltip: !prevState.logoutTooltip\n\t\t}));\n\t}\n\n\thandleLogin() {\n\t\tconst provider = new window.firebase.auth.FacebookAuthProvider();\n\t\twindow.firebase.auth().signInWithPopup(provider).then(function(result) {\n\t\t\tconst token = result.credential.accessToken;\n\t\t\tconst fbid = result.user.providerData[0].uid;\n\t\t\t// const uuid = result.user.uid;\n\t\t\tfetch(`https://graph.facebook.com/v2.10/${ fbid }?fields=link&access_token=${ token }`)\n\t\t\t\t.then((res) => res.json())\n\t\t\t\t// FIXME: 拿不到 fb userlink (userLink & fbLink)\n\t\t\t\t// .then(({ link }) => window.firebase.database().ref(`/userLink/${ uuid }`).set(link))\n\t\t\t\t.then(() => window.location.reload());\n\t\t}).catch(function(error) {\n\t\t\tconst errorCode = error.code;\n\t\t\tconst errorMessage = error.message;\n\t\t\tconsole.error(`[${errorCode}] ${errorMessage}`)\n\t\t});\n\t}\n\n\thandleLogout() {\n\t\twindow.firebase.auth().signOut().then(function() {\n\t\t\twindow.location.reload();\n\t\t}).catch(function(error) {\n\t\t\tconsole.error(error);\n\t\t});\n\t}\n\n\trender() {\n\t\tconst route = this.context.router.route;\n\t\tconst user = this.context.user;\n\t\tconst loginStatusInit = !!user;\n\t\tconst isLogin = loginStatusInit && !!user.uid;\n\t\treturn (\n\t\t\t<NavigationBar color=\"dark\" dark expand=\"sm\">\n\t\t\t\t<NavbarBrand href={process.env.REACT_APP_BASE_URL}>\n\t\t\t\t\t<img src={`${process.env.REACT_APP_BASE_URL}/logo.png`} alt=\"\" height=\"31px\"/> 自己的課表自己排 2.0\n\t\t\t\t</NavbarBrand>\n\t\t\t\t<NavbarToggler onClick={this.toggleNavbar} />\n\t\t\t\t<Collapse isOpen={this.state.navbarIsOpen} navbar>\n\t\t\t\t\t<Nav navbar>\n\t\t\t\t\t\t<NavItem>\n\t\t\t\t\t\t\t<Link className={route.match.path === '/' ? 'active nav-link' : ' nav-link'} to=\"/\">\n\t\t\t\t\t\t\t\t<i className=\"fa fa-table\" aria-hidden=\"true\"></i> <span className=\"d-sm-none d-md-inline\"><Hide850>我的</Hide850>課表</span>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</NavItem>\n\t\t\t\t\t\t<NavItem>\n\t\t\t\t\t\t\t<Link className={route.match.path === '/exchange' ? 'active nav-link' : ' nav-link'} to=\"/exchange\">\n\t\t\t\t\t\t\t\t<i className=\"fa fa-exchange\" aria-hidden=\"true\"></i> <span className=\"d-sm-none d-md-inline\">換課<Hide850>平台</Hide850></span>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</NavItem>\n\t\t\t\t\t\t<NavItem>\n\t\t\t\t\t\t\t<Link className={route.match.path === '/review' ? 'active nav-link' : ' nav-link'} to=\"/review\">\n\t\t\t\t\t\t\t\t<i className=\"fa fa-thumbs-up\" aria-hidden=\"true\"></i> <span className=\"d-sm-none d-md-inline\"><Hide850>課程</Hide850>評價</span>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</NavItem>\n\t\t\t\t\t\t<NavItem>\n\t\t\t\t\t\t\t<NavLink href=\"https://fb.com/MOLi.rocks/posts/2104134533131853\" target=\"_blank\">\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t<i className=\"fa fa-question-circle\" aria-hidden=\"true\"></i> <span className=\"d-sm-none d-md-inline\">選課教學</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</NavLink>\n\t\t\t\t\t\t</NavItem>\n\t\t\t\t\t\t<NavItem>\n\t\t\t\t\t\t\t<NavLink href=\"https://github.com/x3388638/KeBiau/issues\" target=\"_blank\">\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t<i className=\"fa fa-exclamation-circle\" aria-hidden=\"true\"></i> <span className=\"d-sm-none d-md-inline\">回報</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</NavLink>\n\t\t\t\t\t\t</NavItem>\n\t\t\t\t\t</Nav>\n\t\t\t\t\t<Nav className=\"ml-auto\" navbar>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tloginStatusInit && isLogin &&\n\t\t\t\t\t\t\t<NavItem>\n\t\t\t\t\t\t\t\t<NavLink href={ user.fbLink || `https://fb.com/${ user.uid }` } target=\"_blank\">\n\t\t\t\t\t\t\t\t\t<UserImg src={`https://graph.facebook.com/${user.uid}/picture`} alt=\"\" height=\"21\" />\n\t\t\t\t\t\t\t\t\t<UserName className=\"ml-2\">{ user.displayName }</UserName>\n\t\t\t\t\t\t\t\t</NavLink>\n\t\t\t\t\t\t\t</NavItem>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tloginStatusInit &&\n\t\t\t\t\t\t\t<NavItem>\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tisLogin &&\n\t\t\t\t\t\t\t\t\t<NavLink id=\"LogoutBtn\" href=\"#\" onClick={this.handleLogout}>\n\t\t\t\t\t\t\t\t\t\t<i className=\"fa fa-sign-out\" aria-hidden=\"true\"></i> <span className=\"d-inline d-sm-none\">登出</span>\n\t\t\t\t\t\t\t\t\t\t<Tooltip delay={{ show: 0, hide: 0 }} placement=\"left\" isOpen={this.state.logoutTooltip} target=\"LogoutBtn\" toggle={this.toggleLogoutTooltip}>\n\t\t\t\t\t\t\t\t\t\t\t登出\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t</NavLink>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tisLogin ||\n\t\t\t\t\t\t\t\t\t<NavLink id=\"LoginBtn\" href=\"#\" onClick={this.handleLogin}>\n\t\t\t\t\t\t\t\t\t\t<i className=\"fa fa-facebook-square\" aria-hidden=\"true\"></i>\n\t\t\t\t\t\t\t\t\t\t<Tooltip delay={{ show: 0, hide: 0 }} placement=\"left\" isOpen={this.state.loginTooltip} target=\"LoginBtn\" toggle={this.toggleLoginTooltip}>\n\t\t\t\t\t\t\t\t\t\t\t登入 Facebook\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t</NavLink>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</NavItem>\n\t\t\t\t\t\t}\n\t\t\t\t\t</Nav>\n\t\t\t\t</Collapse>\n\t\t\t</NavigationBar>\n\t\t);\n\t}\n}\n\nNavigation.contextTypes = {\n\tuser: PropTypes.object,\n\trouter: PropTypes.object\n};\n","import React from 'react';\nimport { Container } from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nimport Navigation from './Navigation.jsx';\n\nimport './App.css';\n\nconst RelativeContainer = styled(Container)`\n\tposition: relative;\n`;\n\nexport default class App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tuser: null\n\t\t};\n\n\t\tthis.db = window.firebase.database();\n\t\twindow.firebase.auth().onAuthStateChanged((user) => {\n\t\t\tif (user) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tuser: Object.assign({}, user.providerData[0], {\n\t\t\t\t\t\tuuid: user.uid\n\t\t\t\t\t})\n\t\t\t\t});\n\n\t\t\t\t// FIXME: 拿不到 fb userlink (userLink & fbLink)\n\t\t\t\t// setTimeout(() => {\n\t\t\t\t// \tthis.db.ref(`/userLink/${user.uid}`).once('value').then((snapshot) => {\n\t\t\t\t// \t\tif (!snapshot.val()) {\n\t\t\t\t// \t\t\twindow.firebase.auth().signOut().then(() => {\n\t\t\t\t// \t\t\t\tthis.setState({\n\t\t\t\t// \t\t\t\t\tuser: {\n\t\t\t\t// \t\t\t\t\t\tuid: null\n\t\t\t\t// \t\t\t\t\t}\n\t\t\t\t// \t\t\t\t}, () => {\n\t\t\t\t// \t\t\t\t\twindow.location.reload();\n\t\t\t\t// \t\t\t\t});\n\t\t\t\t// \t\t\t}).catch(console.error);\n\t\t\t\t// \t\t\treturn;\n\t\t\t\t// \t\t}\n\n\t\t\t\t// \t\tthis.setState({\n\t\t\t\t// \t\t\tuser: Object.assign({}, user.providerData[0], {\n\t\t\t\t// \t\t\t\tuuid: user.uid,\n\t\t\t\t// \t\t\t\tfbLink: snapshot.val()\n\t\t\t\t// \t\t\t})\n\t\t\t\t// \t\t});\n\t\t\t\t// \t});\n\t\t\t\t// }, 1000);\n\t\t\t} else {\n\t\t\t\tthis.setState({\n\t\t\t\t\tuser: {\n\t\t\t\t\t\tuid: null\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tgetChildContext() {\n\t\treturn {\n\t\t\tuser: this.state.user\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Navigation />\n\t\t\t\t<RelativeContainer>\n\t\t\t\t\t{this.props.children}\n\t\t\t\t</RelativeContainer>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nApp.childContextTypes = {\n\tuser: PropTypes.object\n};\n","import React from 'react';\nimport { BarLoader } from 'react-spinners';\nimport styled from 'styled-components';\n\nconst LoadingWrapper = styled.div`\n\tdisplay: flex;\n\tjustify-content: center;\n\tmargin-top: ${ props => `${ props.marginTop || 20 }px` };\n`;\n\nexport default class Loading extends React.PureComponent {\n\trender() {\n\t\treturn (\n\t\t\t<LoadingWrapper {...this.props}>\n\t\t\t\t<BarLoader\n\t\t\t\t\tcolor=\"#666\"\n\t\t\t\t\tloading\n\t\t\t\t\theight={ 5 }\n\t\t\t\t\twidth={ 200 }\n\t\t\t\t/>\n\t\t\t</LoadingWrapper>\n\t\t)\n\t}\n}\n","import React from 'react';\nimport { Button } from 'reactstrap';\nimport styled from 'styled-components'\nimport Loading from './Loading';\n\nconst CommonRow = styled.div`\n\tdisplay: grid;\n\tgrid-template-columns: 2fr 3fr 1fr 1fr 2fr 3fr 1fr 1fr 1fr;\n\tgrid-gap: 2px;\n\tmargin: 5px;\n`;\n\nconst TableHeader = styled(CommonRow)`\n\tmargin: 0 5px 5px;\n\tposition: sticky;\n    top: 0;\n    left: 0;\n    background: #fff;\n    z-index: 10;\n    border-bottom: 1px solid #adadad;\n\t& span {\n\t\tpadding: 10px 0px;\n\t\tfont-weight: bold;\n\t}\n\n\t@media screen and (max-width: 992px) {\n\t\tdisplay: none;\n\t}\n`;\n\nconst TableRow = styled(CommonRow)`\n\tbackground: #f9f9f9;\n\tborder-radius: 2px;\n\t& span {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 5px;\n\t\t&.TableRow__link,\n\t\t&.TableRow__btn {\n\t\t\tjustify-content: center;\n\t\t}\n\t}\n\n\t@media screen and (max-width: 991px) {\n\t\tpadding: 5px;\n\t\tbox-shadow: 1px 1px 2px 0px #878787;\n\t\tmargin-bottom: 10px;\n\t\tgrid-template-columns: 1fr 3fr 1fr;\n\t\tgrid-template-rows: 1fr 1fr 1fr 1fr;\n\t\tgrid-template-areas: \"cid cname classes\"\n\t\t\t\"teacher teacher teacher\"\n\t\t\t\"time time time\"\n\t\t\t\"location location location\"\n\t\t\t\"link link btn\";\n\t\t& span {\n\t\t\tpadding: 0 8px;\n\t\t}\n\n\t\t& span.TableRow__cid {\n\t\t\tgrid-area: cid;\n\t\t}\n\t\t& span.TableRow__cname {\n\t\t\tgrid-area: cname;\n\t\t\tjustify-content: center;\n\t\t\tfont-weight: bold;\n\t\t}\n\t\t& span.TableRow__classes {\n\t\t\tgrid-area: classes;\n\t\t\tjustify-content: flex-end;\n\t\t\t&::after {\n\t\t\t\tcontent: '班';\n\t\t\t\tpadding-left: 2px;\n\t\t\t}\n\t\t}\n\t\t& span.TableRow__time {\n\t\t\tgrid-area: time;\n\t\t\t&::before {\n\t\t\t\tcontent: '時間:';\n\t\t\t\tpadding-right: 2px;\n\t\t\t}\n\t\t}\n\t\t& span.TableRow__location {\n\t\t\tgrid-area: location;\n\t\t\t&::before {\n\t\t\t\tcontent: '地點:';\n\t\t\t\tpadding-right: 2px;\n\t\t\t}\n\t\t}\n\t\t& span.TableRow__teacher {\n\t\t\tgrid-area: teacher;\n\t\t\t&::before {\n\t\t\t\tcontent: '教師:';\n\t\t\t\tpadding-right: 2px;\n\t\t\t}\n\t\t}\n\t\t& span.TableRow__grade {\n\t\t\tdisplay: none;\n\t\t}\n\t\t& span.TableRow__link {\n\t\t\tgrid-area: link;\n\t\t\tjustify-content: flex-end;\n\t\t}\n\t\t& span.TableRow__btn {\n\t\t\tgrid-area: btn;\n\t\t\t& button {\n\t\t\t\twidth: 100%;\n\t\t\t}\n\t\t}\n\t}\n`;\n\nclass DeptSelector extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tselected: ''\n\t\t};\n\n\t\tthis.handleSelect = this.handleSelect.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.setState({\n\t\t\tselected: '通識'\n\t\t});\n\t}\n\n\thandleSelect(e) {\n\t\tthis.setState({\n\t\t\tselected: e.target.value\n\t\t});\n\n\t\tthis.props.onChangeDept(e.target.value);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"mb-2\">\n\t\t\t\t<strong>開課單位：</strong>\n\t\t\t\t<select value={this.state.selected} onChange={this.handleSelect}>\n\t\t\t\t\t{\n\t\t\t\t\t\tObject.keys(this.props.deptList).map((val, i) => {\n\t\t\t\t\t\t\treturn (<option key={ i } value={ val }>{ val }</option>);\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t</select> {' '}\n\t\t\t\t<Button\n\t\t\t\t\tclassName={this.props.filterCourse ? 'active' : ''}\n\t\t\t\t\tcolor={this.props.filterCourse ? 'danger' : 'light'}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tonClick={this.props.onFilterCourse}\n\t\t\t\t>\n\t\t\t\t\t篩選課程\n\t\t\t\t</Button> {' '}\n\t\t\t\t<Button\n\t\t\t\t\tclassName={this.props.filterConflict ? 'active' : ''}\n\t\t\t\t\tcolor={this.props.filterConflict ? 'danger' : 'light'}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tonClick={this.props.onFilterConflict}\n\t\t\t\t>\n\t\t\t\t\t{ this.props.filterConflict ? '取消過濾' : '過濾衝堂' }\n\t\t\t\t</Button>\n\t\t\t\t<a className=\"float-right mr-2 text-warning\" href=\"https://ccweb.ncnu.edu.tw/student/DeptQuerylist.php\" target=\"_blank\" rel=\"noopener noreferrer\">\n\t\t\t\t\t<i className=\"fa fa-sitemap\" aria-hidden=\"true\"></i> 各系所課程地圖\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default class CourseList extends React.Component {\n\trender() {\n\t\tconst list = this.props.courseList;\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<DeptSelector { ...this.props } />\n\t\t\t\t<div style={{overflow: 'auto', maxHeight: '487px', background: '#fff', width: '100%'}}>\n\t\t\t\t\t{ !list.length &&\n\t\t\t\t\t\t<Loading />\n\t\t\t\t\t}\n\n\t\t\t\t\t{ !!list.length &&\n\t\t\t\t\t\t<React.Fragment>\n\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t<span>課號</span>\n\t\t\t\t\t\t\t\t<span>課程名稱</span>\n\t\t\t\t\t\t\t\t<span>班別</span>\n\t\t\t\t\t\t\t\t<span>時段</span>\n\t\t\t\t\t\t\t\t<span>授課地點</span>\n\t\t\t\t\t\t\t\t<span>教師</span>\n\t\t\t\t\t\t\t\t<span>年級</span>\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tObject.keys(list).map((val) =>\n\t\t\t\t\t\t\t\t\tthis.props.filterConflict && list[val].isConflict ? null : (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={val} data-uuid={val}>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"TableRow__cid\">{list[val].cid}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"TableRow__cname\">{list[val].cname}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"TableRow__classes\">{list[val].classes}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"TableRow__time\">{list[val].time}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"TableRow__location\">{list[val].location}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"TableRow__teacher\">{list[val].teacher}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"TableRow__grade\">{list[val].grade}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"TableRow__link\">\n\t\t\t\t\t\t\t\t\t\t\t\t<a href={`https://ccweb.ncnu.edu.tw/student/aspmaker_course_opened_detail_viewview.php?showdetail=&year=${list[val].year}&courseid=${list[val].cid}&_class=${list[val].classes}&modal=0`} target=\"_blank\">課綱 <i className=\"fa fa-external-link\" aria-hidden=\"true\"></i></a>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"TableRow__btn\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Button color=\"success\" size=\"sm\" disabled={list[val].isConflict ? true : false} onClick={() => { this.props.onAddCourse(list[val], true) }}>{list[val].isConflict ? '衝堂' : '加入'}</Button>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst EditBtnContainer = styled.span`\n\ttop: -8px;\n\tposition: relative;\n`;\n\nconst DelBtn = styled.span`\n\tdisplay: none;\n\tcursor: pointer;\n\tcolor: #c9302c !important;\n\tfont-size: 20px;\n`;\n\nconst EditBtn = styled.i`\n\tdisplay: none;\n\tcursor: pointer;\n\tfont-size: 14px;\n\t&:hover {\n\t\tcolor: #0275d8;\n\t}\n`;\n\nconst Grid = styled.td`\n\tvertical-align: middle !important;\n\tbackground: ${(props) => `${props.bg} !important` || 'none'};\n\tcolor: ${ _getTextColor};\n\t&:hover {\n\t\tbackground: #fafafa;\n\t\t${ DelBtn} {\n\t\t\tdisplay: initial;\n\t\t}\n\n\t\t${ EditBtn} {\n\t\t\tdisplay: initial;\n\t\t}\n\t}\n`;\n\nfunction _getTextColor(props) {\n\tif (props.bg) {\n\t\tconst { r, g, b } = _hexToRgb(props.bg);\n\t\tconst bri = Math.sqrt(r * r * 0.241 + g * g * 0.691 + b * b * 0.068);\n\t\tif (bri < 125) {\n\t\t\treturn '#fff';\n\t\t}\n\n\t\treturn '';\n\t}\n\n\treturn '';\n}\n\nfunction _hexToRgb(hex) {\n\tconst result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\treturn result ? {\n\t\tr: parseInt(result[1], 16),\n\t\tg: parseInt(result[2], 16),\n\t\tb: parseInt(result[3], 16)\n\t} : null;\n}\n\nexport default class CourseGrid extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tmouseEnter: false\n\t\t};\n\n\t\tthis.handleMouseEnter = this.handleMouseEnter.bind(this);\n\t\tthis.handleMouseLeave = this.handleMouseLeave.bind(this);\n\t\tthis.handleDel = this.handleDel.bind(this);\n\t\tthis.handleEdit = this.handleEdit.bind(this);\n\t}\n\n\thandleMouseEnter() {\n\t\tthis.setState({\n\t\t\tmouseEnter: true\n\t\t});\n\t}\n\n\thandleMouseLeave() {\n\t\tthis.setState({\n\t\t\tmouseEnter: false\n\t\t});\n\t}\n\n\thandleDel(e) {\n\t\tif (this.props.shared) return;\n\t\tconst time = e.target.parentNode.parentNode.parentNode.getAttribute('data-time');\n\t\tconst rowspan = e.target.parentNode.parentNode.getAttribute('rowspan');\n\t\tthis.props.onDelCourse(time, rowspan, this.props.dayOfWeek);\n\t}\n\n\thandleEdit(e) {\n\t\tif (this.props.shared) return;\n\t\tthis.props.onEditCourse({\n\t\t\ttime: e.target.parentNode.parentNode.parentNode.parentNode.getAttribute('data-time'),\n\t\t\tdayOfWeek: this.props.dayOfWeek,\n\t\t\ttitle: this.props.title,\n\t\t\tdesc: this.props.desc,\n\t\t\tbg: this.props.bg,\n\t\t});\n\t}\n\n\thexToRgb(hex) {\n\t\tconst result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\t\treturn result ? {\n\t\t\tr: parseInt(result[1], 16),\n\t\t\tg: parseInt(result[2], 16),\n\t\t\tb: parseInt(result[3], 16)\n\t\t} : null;\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Grid bg={this.props.bg} rowSpan={this.props.rowspan || 1} onMouseEnter={this.handleMouseEnter} onMouseLeave={this.handleMouseLeave}>\n\t\t\t\t{!this.props.shared && this.props.title && this.state.mouseEnter &&\n\t\t\t\t\t<span className=\"float-right mr-2\">\n\t\t\t\t\t\t<DelBtn className=\"text-danger\" onClick={this.handleDel}>&times;</DelBtn><br />\n\t\t\t\t\t\t<EditBtnContainer>\n\t\t\t\t\t\t\t<EditBtn className=\"fa fa-pencil\" aria-hidden=\"true\" onClick={this.handleEdit}></EditBtn>\n\t\t\t\t\t\t</EditBtnContainer>\n\t\t\t\t\t</span>\n\t\t\t\t}\n\n\t\t\t\t{this.props.title && this.props.title}\n\t\t\t\t<br className=\"uniBR\" />\n\t\t\t\t{this.props.desc && this.props.desc}\n\t\t\t</Grid>\n\t\t)\n\t}\n}\n","import React from 'react';\nimport {\n\tTable\n} from 'reactstrap';\nimport styled from 'styled-components';\n\nimport CourseGrid from './CourseGrid';\n\nconst DelBtn = styled.i`\n\tdisplay: none;\n\t&:hover {\n\t\tcursor: pointer;\n\t\tcolor: #c9302c !important;\n\t}\n`;\n\nconst WeekendTitle = styled.th`\n\twidth: auto;\n\t&:hover {\n\t\t${ DelBtn } {\n\t\t\tdisplay: initial\n\t\t}\n\t}\n`;\n\nexport default class CourseTable extends React.Component {\n\tcomponentDidUpdate() {\n\t\tconst classArr = document.getElementById('CustomTable').className.replace('table-bordered', '').trim().split(' ');\n\t\tdocument.getElementById('CustomTable').className = classArr.join(' ');\n\t\tsetTimeout(() => {\n\t\t\tdocument.getElementById('CustomTable').className += ' table-bordered';\n\t\t}, 1);\n\t}\n\n\trender() {\n\t\tconst timeNo = ['a/08', 'b/09', 'c/10', 'd/11', 'z/12', 'e/13', 'f/14', 'g/15', 'h/16', 'i/17', 'j/18', 'k/19', 'l/20', 'm/21'];\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Table id=\"CustomTable\" bordered responsive size=\"sm\" style={{background: '#fff', tableLayout: 'fixed'}}>\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th style={{width: '60px'}}></th>\n\t\t\t\t\t\t\t<th className=\"text-center\">星期一</th>\n\t\t\t\t\t\t\t<th className=\"text-center\">星期二</th>\n\t\t\t\t\t\t\t<th className=\"text-center\">星期三</th>\n\t\t\t\t\t\t\t<th className=\"text-center\">星期四</th>\n\t\t\t\t\t\t\t<th className=\"text-center\">星期五</th>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.props.tableData.sat &&\n\t\t\t\t\t\t\t\t<WeekendTitle className=\"text-center\">\n\t\t\t\t\t\t\t\t\t星期六{' '}\n\t\t\t\t\t\t\t\t\t<DelBtn\n\t\t\t\t\t\t\t\t\t\tclassName=\"fa fa-times-circle text-danger\"\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => {!this.props.shared && this.props.onDelSatOrSun('sat')}}\n\t\t\t\t\t\t\t\t\t></DelBtn>\n\t\t\t\t\t\t\t\t</WeekendTitle>\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.props.tableData.sun &&\n\t\t\t\t\t\t\t\t<WeekendTitle className=\"text-center\">\n\t\t\t\t\t\t\t\t\t星期日{' '}\n\t\t\t\t\t\t\t\t\t<DelBtn\n\t\t\t\t\t\t\t\t\t\tclassName=\"fa fa-times-circle text-danger\"\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => {!this.props.shared &&this.props.onDelSatOrSun('sun')}}\n\t\t\t\t\t\t\t\t\t></DelBtn>\n\t\t\t\t\t\t\t\t</WeekendTitle>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttimeNo.map((t, i) => {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<tr data-time={t} key={i}>\n\t\t\t\t\t\t\t\t\t\t<th className=\"text-center\">{t}</th>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tObject.keys(this.props.tableData.course[t]).map((key, i) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst courseData = this.props.tableData.course[t][key];\n\t\t\t\t\t\t\t\t\t\t\t\tif (courseData === null) {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (!this.props.tableData.sat && key === '5') {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (!this.props.tableData.sun && key === '6') {\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CourseGrid\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...courseData}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdayOfWeek={key}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshared={this.props.shared}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDelCourse={this.props.onDelCourse}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonEditCourse={this.props.onEditCourse}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t</tbody>\n\t\t\t\t</Table>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport {\n\tButton,\n\tButtonDropdown,\n\tDropdownToggle,\n\tDropdownMenu,\n\tDropdownItem\n} from 'reactstrap';\n\nexport default class ToolBar extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\texportDropdownOpen: false,\n\t\t\tclearDropdownOpen: false\n\t\t};\n\n\t\tthis.toggleExportDropdown = this.toggleExportDropdown.bind(this);\n\t\tthis.toggleClearDropdown = this.toggleClearDropdown.bind(this);\n\t}\n\n\ttoggleExportDropdown() {\n\t\tthis.setState((prevState) => ({\n\t\t\texportDropdownOpen: !prevState.exportDropdownOpen\n\t\t}));\n\t}\n\n\ttoggleClearDropdown() {\n\t\tthis.setState((prevState) => ({\n\t\t\tclearDropdownOpen: !prevState.clearDropdownOpen\n\t\t}));\n\t}\n\n\thandleExportExcel(e) {\n\t\tdocument.querySelectorAll('.uniBR').forEach((val) => {\n\t\t\tval.setAttribute('style', 'mso-data-placement:same-cell');\n\t\t});\n\t\tconst html= '<html><head><meta charset=\"utf-8\"></head><body>' + document.getElementById('CustomTable').parentNode.innerHTML + '</body></html>';\n\t\twindow.open('data:application/vnd.ms-excel,' + encodeURIComponent(html));\n\t\te.preventDefault();\n\t}\n\n\thandleExportPNG() {\n\t\twindow.html2canvas(document.querySelectorAll('#CustomTable'), {\n\t\t\tonrendered: function (canvas) {\n\t\t\t\t//\n\t\t\t}\n\t\t});\n\t\twindow.html2canvas(document.querySelectorAll('#CustomTable'), {\n\t\t\tonrendered: function (canvas) {\n\t\t\t\twindow.Canvas2Image.saveAsPNG(canvas);\n\t\t\t}\n\t\t});\n\t}\n\n\trender() {\n\t\tconst btnStyle = {cursor: 'pointer', marginBottom: '5px'};\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Button color=\"primary\" size=\"sm\" className=\"mr-1\" style={btnStyle} onClick={this.props.onSave}>\n\t\t\t\t\t<i className=\"fa fa-floppy-o\" aria-hidden=\"true\"></i> <span className=\"d-none d-sm-inline\">儲存</span>\n\t\t\t\t</Button> \n\t\t\t\t<Button color=\"light\" size=\"sm\" className=\"mr-1\" style={btnStyle} onClick={this.props.onShare}>\n\t\t\t\t\t<i className=\"fa fa-share-square-o\" aria-hidden=\"true\"></i> <span className=\"d-none d-sm-inline\">分享</span>\n\t\t\t\t</Button>\n\t\t\t\t<ButtonDropdown className=\"mr-1\" isOpen={ this.state.exportDropdownOpen } style={ btnStyle } size=\"sm\" toggle={ this.toggleExportDropdown }>\n\t\t\t\t\t<DropdownToggle caret color=\"light\">\n\t\t\t\t\t\t<i className=\"fa fa-download\" aria-hidden=\"true\"></i> <span className=\"d-none d-sm-inline\">匯出</span>\n\t\t\t\t\t</DropdownToggle>\n\t\t\t\t\t<DropdownMenu>\n\t\t\t\t\t\t<DropdownItem onClick={ this.handleExportExcel }>\n\t\t\t\t\t\t\t<i className=\"fa fa-file-excel-o\" aria-hidden=\"true\"></i> .xls\n\t\t\t\t\t\t</DropdownItem>\n\t\t\t\t\t\t<DropdownItem onClick={ this.handleExportPNG }>\n\t\t\t\t\t\t\t<i className=\"fa fa-file-image-o\" aria-hidden=\"true\"></i> .png\n\t\t\t\t\t\t</DropdownItem>\n\t\t\t\t\t</DropdownMenu>\n\t\t\t\t</ButtonDropdown>\n\t\t\t\t<span className=\"ml-2 mr-2\"></span>\n\t\t\t\t<ButtonDropdown className=\"mr-1\" isOpen={ this.state.clearDropdownOpen } style={ btnStyle } size=\"sm\" toggle={ this.toggleClearDropdown }>\n\t\t\t\t\t<DropdownToggle caret color=\"light\">\n\t\t\t\t\t\t<i className=\"fa fa-repeat\" aria-hidden=\"true\"></i> <span className=\"d-none d-sm-inline\">清除</span>\n\t\t\t\t\t</DropdownToggle>\n\t\t\t\t\t<DropdownMenu>\n\t\t\t\t\t\t<DropdownItem onClick={ this.props.onReColor }>\n\t\t\t\t\t\t\t<i className=\"fa fa-magic\" aria-hidden=\"true\"></i> 標記\n\t\t\t\t\t\t</DropdownItem>\n\t\t\t\t\t\t<DropdownItem onClick={ this.props.onReTable }>\n\t\t\t\t\t\t\t<i className=\"fa fa-table\" aria-hidden=\"true\"></i> 課表\n\t\t\t\t\t\t</DropdownItem>\n\t\t\t\t\t</DropdownMenu>\n\t\t\t\t</ButtonDropdown>\n\t\t\t\t<Button color=\"light\" size=\"sm\" className=\"mr-1\" style={btnStyle} onClick={this.props.onClickCustom}>\n\t\t\t\t\t<i className=\"fa fa-plus\" aria-hidden=\"true\"></i> <span className=\"d-none d-sm-inline\">自訂時段</span>\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport {\n\tRow,\n\tCol,\n\tModal,\n\tModalHeader,\n\tModalBody,\n\tModalFooter,\n\tButton,\n\tForm,\n\tFormGroup,\n\tLabel,\n\tInput\n} from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport cloneDeep from 'lodash.clonedeep';\n\nimport CourseList from './CourseList.jsx';\nimport CourseTable from './CourseTable.jsx';\nimport ToolBar from './ToolBar.jsx';\n\nexport default class CourseTableContainer extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tdeptList: {},\n\t\t\tcourseList: {},\n\t\t\tcustomTable: {\n\t\t\t\tcourse: {\n\t\t\t\t\t'a/08': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'b/09': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'c/10': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'd/11': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'z/12': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'e/13': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'f/14': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'g/15': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'h/16': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'i/17': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'j/18': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'k/19': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'l/20': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t\t'm/21': {0: {}, 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}},\n\t\t\t\t},\n\t\t\t\tsat: false,\n\t\t\t\tsun: false\n\t\t\t},\n\t\t\tmodalEditCourse: {\n\t\t\t\topen: false,\n\t\t\t\tmodalTitle: '編輯課程',\n\t\t\t\ttitle: '',\n\t\t\t\tdesc: '',\n\t\t\t\tbg: ''\n\t\t\t},\n\t\t\tmodalCustomCourseOpen: false,\n\t\t\tfilterConflict: false,\n\t\t\tmodalFilterCourseOpen: false,\n\t\t\tfilterCourseForm: {\n\t\t\t\tcname: '',\n\t\t\t\tteacher: '',\n\t\t\t\ttime: '',\n\t\t\t\tlocation: ''\n\t\t\t}\n\t\t};\n\t\tthis.timeMap = {a: 'a/08', b: 'b/09', c: 'c/10', d: 'd/11', z: 'z/12', e: 'e/13', f: 'f/14',\n\t\t\tg: 'g/15', h: 'h/16', i: 'i/17', j: 'j/18', k: 'k/19', l: 'l/20', m: 'm/21'};\n\t\tthis.timeOrder = ['a', 'b', 'c', 'd', 'z', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm'];\n\t\tthis.db = window.firebase.database();\n\t\tthis.getCourseList = this.getCourseList.bind(this);\n\t\tthis.getCourseData = this.getCourseData.bind(this);\n\t\tthis.changeDept = this.changeDept.bind(this);\n\t\tthis.getTableData = this.getTableData.bind(this);\n\t\tthis.checkConflict = this.checkConflict.bind(this);\n\t\tthis.handleDelSatOrSun = this.handleDelSatOrSun.bind(this);\n\t\tthis.handleDelCourse = this.handleDelCourse.bind(this);\n\t\tthis.handleOpenEditModal = this.handleOpenEditModal.bind(this);\n\t\tthis.toggleModalEditCourse = this.toggleModalEditCourse.bind(this);\n\t\tthis.handleEditCourse = this.handleEditCourse.bind(this);\n\t\tthis.handleReColor = this.handleReColor.bind(this);\n\t\tthis.handleReTable = this.handleReTable.bind(this);\n\t\tthis.toggleModalCustomCourse = this.toggleModalCustomCourse.bind(this);\n\t\tthis.handleAddCustomCourse = this.handleAddCustomCourse.bind(this);\n\t\tthis.handleSave = this.handleSave.bind(this);\n\t\tthis.handleShare = this.handleShare.bind(this);\n\t\tthis.filterConflict = this.filterConflict.bind(this);\n\t\tthis.toggleModalFilterCourse = this.toggleModalFilterCourse.bind(this);\n\t\tthis.handleFilterCourse = this.handleFilterCourse.bind(this);\n\t\tthis.handleClearFilterCourse = this.handleClearFilterCourse.bind(this);\n\t\tthis.handleFilterCourseChange = this.handleFilterCourseChange.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.getCourseData();\n\t\tthis.getTableData();\n\t}\n\n\tgetCourseList(dept = '通識') {\n\t\tconst sessionCourseList = window.sessionStorage.courseList ? JSON.parse(window.sessionStorage.courseList) : \"{}\";\n\t\t/*\n\t\tif (sessionCourseList[dept]) {\n\t\t\t// console.log(`course in ${dept} exist in sessionStorage`);\n\t\t\tthis.setState({\n\t\t\t\tcourseList: Object.assign({}, sessionCourseList[dept])\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\t*/\n\t\t\n\t\t// console.log(`Getting course in ${dept}`);\n\t\tthis.db.ref(`course/${dept}`).once('value').then((snapshot) => {\n\t\t\tthis.setState({\n\t\t\t\tcourseList: snapshot.val() || {}\n\t\t\t});\n\t\t\twindow.sessionStorage.courseList = JSON.stringify(Object.assign({}, sessionCourseList, {[dept]: snapshot.val()}));\n\t\t});\n\t}\n\n\tgetCourseData() {\n\t\t// console.log('Getting course data...');\n\t\tif (/* !window.sessionStorage.deptList */ true) {\n\t\t\t// console.log('Getting deptList from db...')\n\t\t\tthis.db.ref('deptList/').once('value').then((snapshot) => {\n\t\t\t\twindow.sessionStorage.deptList = JSON.stringify(snapshot.val() || {});\n\t\t\t\tthis.setState({\n\t\t\t\t\tdeptList: snapshot.val() || {}\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\t// console.log('deptList exist in sessionStorage.')\n\t\t\tthis.setState({\n\t\t\t\tdeptList: Object.assign({}, JSON.parse(window.sessionStorage.deptList))\n\t\t\t});\n\t\t}\n\n\t\tthis.getCourseList();\n\t}\n\n\tchangeDept(dept) {\n\t\tthis.getCourseList(dept);\n\t}\n\n\tgetTableData() {\n\t\tconst user = this.context.user;\n\t\tif (user === null) {\n\t\t\tsetTimeout(this.getTableData, 100);\n\t\t\treturn;\n\t\t}\n\n\t\tif (user.uid) {\n\t\t\t// logged in, get data from db\n\t\t\t// console.log('Getting custom table data');\n\t\t\tthis.db.ref(`customTable/${user.uuid}`).once('value').then((snapshot) => {\n\t\t\t\tconst tableData = snapshot.val();\n\t\t\t\ttableData && this.setState({\n\t\t\t\t\tcustomTable: Object.assign({}, JSON.parse(tableData))\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckConflict(courseData, shouldAddCourse) {\n\t\t// if !shouldAddCourse => only check course conflict\n\t\t// validate time\n\t\tconst time = courseData.time.toLowerCase(); // '2bc3g'\n\t\tconst sections = this.apartCourseTime(time); // ['abc', '3g']\n\t\tlet timeValid = true;\n\t\tsections.some((t) => {\n\t\t\tconst valid = this.validateTime(t)\n\t\t\tif (!valid.valid) {\n\t\t\t\tshouldAddCourse && alert(valid.msg);\n\t\t\t\ttimeValid = false;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t});\n\n\t\tif (timeValid) {\n\t\t\tlet conflict = false;\n\t\t\tconst customTable = cloneDeep(this.state.customTable); // prevent call by reference\n\t\t\tsections.forEach((t, index) => {\n\t\t\t\tif (conflict) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst time = t; // 2ab\n\t\t\t\tconst dayOfWeek = time[0]; // 2\n\t\t\t\tconst startTime = time[1]; // a\n\t\t\t\tconst rowspan = time.length - 1; // 2\n\t\t\t\tif (customTable.course[this.timeMap[startTime]][dayOfWeek - 1] === null\n\t\t\t\t\t|| customTable.course[this.timeMap[startTime]][dayOfWeek - 1].title) {\n\t\t\t\t\tconflict = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (shouldAddCourse) {\n\t\t\t\t\tcustomTable.course[this.timeMap[startTime]][dayOfWeek - 1] = { // customTable.course['a/08'][1]\n\t\t\t\t\t\trowspan: rowspan,\n\t\t\t\t\t\ttitle: courseData.cname || courseData.title,\n\t\t\t\t\t\tdesc: courseData.desc || `${courseData.location} ${courseData.teacher}`,\n\t\t\t\t\t\tbg: courseData.bg || ''\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tlet nextTimeOrder = this.timeOrder.indexOf(startTime) + 1;\n\t\t\t\tlet nextTime = this.timeMap[this.timeOrder[nextTimeOrder]];\n\t\t\t\tfor (let i = 0; i < rowspan - 1; i ++) {\n\t\t\t\t\tconst nextTimeCourse = customTable.course[nextTime][dayOfWeek - 1];\n\t\t\t\t\tif (nextTimeCourse === null || nextTimeCourse.title) {\n\t\t\t\t\t\tconflict = true;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tshouldAddCourse && (customTable.course[nextTime][dayOfWeek - 1] = null);\n\t\t\t\t\tnextTimeOrder ++;\n\t\t\t\t\tnextTime = this.timeMap[this.timeOrder[nextTimeOrder]];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!shouldAddCourse) return;\n\n\t\t\t\tif (dayOfWeek === '6' && !customTable.sat) {\n\t\t\t\t\tcustomTable.sat = true;\n\t\t\t\t}\n\n\t\t\t\tif (dayOfWeek === '7' && !customTable.sun) {\n\t\t\t\t\tcustomTable.sun = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!!conflict && shouldAddCourse) {\n\t\t\t\talert('!!! 衝堂 !!!');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tshouldAddCourse && this.setState({\n\t\t\t\tcustomTable: cloneDeep(customTable)\n\t\t\t});\n\n\t\t\treturn conflict;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvalidateTime(t) {\n\t\tif (/^[1-7]{1}[A-MZa-mz]+$/.test(t)) {\n\t\t\tlet last = -1;\n\t\t\tlet err = 0;\n\t\t\tfor (let i = 1; i < t.length; i ++) {\n\t\t\t\tlet current = t[i].charCodeAt();\n\t\t\t\tif (last !== -1) {\n\t\t\t\t\tif (current === 122) { // z\n\t\t\t\t\t\tif (last !== 100) {\n\t\t\t\t\t\t\terr++;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlast = current;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (current === 101) { // e\n\t\t\t\t\t\tif (last !== 122) {\n\t\t\t\t\t\t\terr++;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlast = current;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (current !== (+last +1)) {\n\t\t\t\t\t\terr++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlast = current;\n\t\t\t}\n\n\t\t\tif (err) {\n\t\t\t\treturn {\n\t\t\t\t\tvalid: false, \n\t\t\t\t\tmsg: '時段不連續'\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tvalid: true\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tvalid: false, \n\t\t\t\tmsg: '時間格式錯誤'\n\t\t\t}\n\t\t}\n\t}\n\n\tapartCourseTime(t) {\n\t\tlet result = [];\n\t\tif (t === '') {\n\t\t\treturn ['zzzzz'];\n\t\t}\n\n\t\tif (t.replace(/[1-7]{1}[A-MZa-mz]+/g, '').length > 0) {\n\t\t\tresult.push(t);\n\t\t\treturn result;\n\t\t}\n\n\t\treturn t.match(/[1-7]{1}[A-MZa-mz]+/g);\n\t}\n\n\thandleDelSatOrSun(day) {\n\t\tconst customTable = cloneDeep(this.state.customTable);\n\t\tcustomTable[day] = false;\n\t\tconst dayOrder = day === 'sat' ? 5 : 6;\n\t\tObject.keys(customTable.course).forEach((key, i) => {\n\t\t\tcustomTable.course[key][dayOrder] = {};\n\t\t});\n\n\t\tthis.setState({\n\t\t\tcustomTable: cloneDeep(customTable)\n\t\t});\n\t}\n\n\thandleDelCourse(time, rowspan, dayOfWeek) { // 'a/08', '2', '0'\n\t\tconst customTable = cloneDeep(this.state.customTable);\n\t\tcustomTable.course[time][dayOfWeek] = {};\n\t\tlet nextTimeOrder = this.timeOrder.indexOf(time[0]) + 1;\n\t\tlet nextTime = this.timeMap[this.timeOrder[nextTimeOrder]];\n\t\tfor (let i = 0; i < rowspan - 1; i ++) {\n\t\t\tcustomTable.course[nextTime][dayOfWeek] = {};\n\t\t\tnextTimeOrder ++;\n\t\t\tnextTime = this.timeMap[this.timeOrder[nextTimeOrder]];\n\t\t}\n\n\t\tthis.setState({\n\t\t\tcustomTable: cloneDeep(customTable)\n\t\t});\n\t}\n\n\thandleOpenEditModal(courseData) {\n\t\tconst modalEditCourse = cloneDeep(this.state.modalEditCourse);\n\t\tmodalEditCourse.open = true;\n\t\tmodalEditCourse.modalTitle = `編輯 ${courseData.title}`;\n\t\tmodalEditCourse.title = courseData.title;\n\t\tmodalEditCourse.desc = courseData.desc;\n\t\tmodalEditCourse.bg = courseData.bg;\n\t\tmodalEditCourse.time = courseData.time;\n\t\tmodalEditCourse.dayOfWeek = courseData.dayOfWeek;\n\t\tthis.setState({\n\t\t\tmodalEditCourse: cloneDeep(modalEditCourse)\n\t\t});\n\t}\n\n\ttoggleModalEditCourse() {\n\t\tconst modalEditCourse = cloneDeep(this.state.modalEditCourse);\n\t\tmodalEditCourse.open = !modalEditCourse.open;\n\t\tthis.setState({\n\t\t\tmodalEditCourse: cloneDeep(modalEditCourse)\n\t\t});\n\t}\n\n\thandleEditCourse(time, dayOfWeek) { // 'a/08', '0'\n\t\tif (document.getElementById('ModalEditCourse__inputTitle').value === '') {\n\t\t\talert('標題不得為空');\n\t\t\treturn;\n\t\t}\n\n\t\tconst modalEditCourse = cloneDeep(this.state.modalEditCourse);\n\t\tmodalEditCourse.open = false;\n\n\t\tconst customTable = cloneDeep(this.state.customTable);\n\t\tcustomTable.course[time][dayOfWeek].title = document.getElementById('ModalEditCourse__inputTitle').value;\n\t\tcustomTable.course[time][dayOfWeek].desc = document.getElementById('ModalEditCourse__inputDesc').value;\n\t\tcustomTable.course[time][dayOfWeek].bg = document.getElementById('ModalEditCourse__inputBg').value;\n\n\t\tthis.setState({\n\t\t\tmodalEditCourse: cloneDeep(modalEditCourse),\n\t\t\tcustomTable: cloneDeep(customTable)\n\t\t})\n\t}\n\n\thandleReColor() {\n\t\tconst customTable = cloneDeep(this.state.customTable);\n\t\tObject.keys(customTable.course).forEach((time) => {\n\t\t\tObject.keys(customTable.course[time]).forEach((dayOrder) => {\n\t\t\t\tcustomTable.course[time][dayOrder] && (customTable.course[time][dayOrder].bg = '');\n\t\t\t});\n\t\t});\n\n\t\tthis.setState({\n\t\t\tcustomTable: cloneDeep(customTable)\n\t\t});\n\t}\n\n\thandleReTable() {\n\t\tconst customTable = cloneDeep(this.state.customTable);\n\t\tObject.keys(customTable.course).forEach((time) => {\n\t\t\tObject.keys(customTable.course[time]).forEach((dayOrder) => {\n\t\t\t\tcustomTable.course[time][dayOrder] = {};\n\t\t\t});\n\t\t});\n\n\t\tcustomTable.sat = false;\n\t\tcustomTable.sun = false;\n\t\tthis.setState({\n\t\t\tcustomTable: cloneDeep(customTable)\n\t\t});\n\t}\n\n\ttoggleModalCustomCourse() {\n\t\tthis.setState((prevState) => ({\n\t\t\tmodalCustomCourseOpen: !prevState.modalCustomCourseOpen\n\t\t}));\n\t}\n\n\thandleAddCustomCourse() {\n\t\tconst time = document.getElementById('ModalCustomCourse__inputTime').value;\n\t\tconst title = document.getElementById('ModalCustomCourse__inputTitle').value;\n\t\tif (!time || !title) {\n\t\t\talert('時間、標題不得為空');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.checkConflict({\n\t\t\ttime,\n\t\t\ttitle,\n\t\t\tdesc: document.getElementById('ModalCustomCourse__inputDesc').value || ' ',\n\t\t\tbg: document.getElementById('ModalCustomCourse__inputBg').value\n\t\t}, true);\n\n\t\tthis.toggleModalCustomCourse();\n\t}\n\n\thandleSave() {\n\t\tthis.db.ref(`customTable/${this.context.user.uuid}`).set(JSON.stringify(this.state.customTable)).then(() => {\n\t\t\talert('儲存成功!');\n\t\t});\n\t}\n\n\thandleShare() {\n\t\tconst uuid = this.context.user.uuid;\n\t\tconst hash = (Date.now() * Math.random() * Math.random()).toString(16).replace('.', '').substring(2, 6);\n\t\tthis.db.ref(`sharedTable/${uuid}`).set(JSON.stringify({[hash]: this.state.customTable})).then(() => {\n\t\t\tprompt('已將當前課表分享於以下連結', `${process.env.REACT_APP_BASE_URL}/#/share/${uuid}${hash}`);\n\t\t});\n\t}\n\n\tfilterConflict() {\n\t\tthis.setState((prevState) => ({\n\t\t\tfilterConflict: !prevState.filterConflict\n\t\t}));\n\t}\n\n\ttoggleModalFilterCourse() {\n\t\tthis.setState((prevState) => ({\n\t\t\tmodalFilterCourseOpen: !prevState.modalFilterCourseOpen\n\t\t}));\n\t}\n\n\thandleFilterCourseChange(event, field) {\n\t\tconst value = event.target.value;\n\t\tthis.setState((prevState) => ({\n\t\t\tfilterCourseForm: Object.assign({}, prevState.filterCourseForm, { [field]: value })\n\t\t}));\n\t}\n\n\thandleFilterCourse() {\n\t\tthis.setState(() => ({\n\t\t\tmodalFilterCourseOpen: false\n\t\t}));\n\t}\n\n\thandleClearFilterCourse() {\n\t\tthis.setState(() => ({\n\t\t\tfilterCourseForm: {\n\t\t\t\tcname: '',\n\t\t\t\tteacher: '',\n\t\t\t\ttime: '',\n\t\t\t\tlocation: ''\n\t\t\t},\n\t\t\tmodalFilterCourseOpen: false\n\t\t}));\n\t}\n\n\trender() {\n\t\tlet courseList = cloneDeep(this.state.courseList);\n\t\tlet isFilterCourse = false;\n\t\tconst parsedCourseList = [];\n\t\tconst filterCourseForm = this.state.filterCourseForm;\n\n\t\tObject.keys(courseList).reduce((result, courseKey) => {\n\t\t\tcourseList[courseKey].isConflict = this.checkConflict(courseList[courseKey], false);\n\n\t\t\tconst match = Object.keys(filterCourseForm).every((field) => {\n\t\t\t\tif (filterCourseForm[field] === '') {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tisFilterCourse = true;\n\t\t\t\tif (courseList[courseKey][field].toUpperCase().includes(filterCourseForm[field].toUpperCase())) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\tif (match) {\n\t\t\t\tparsedCourseList.push(courseList[courseKey]);\n\t\t\t}\n\n\t\t\treturn parsedCourseList;\n\t\t}, []);\n\n\t\treturn (\n\t\t\t<div style={{background: '#fff', padding: '20px 5px', boxShadow: '0 0 10px 0 #080808'}}>\n\t\t\t\t<Row className=\"mb-2\">\n\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t{ this.context.user && this.context.user.uid &&\n\t\t\t\t\t\t\t<ToolBar\n\t\t\t\t\t\t\t\tonSave={this.handleSave}\n\t\t\t\t\t\t\t\tonShare={this.handleShare}\n\t\t\t\t\t\t\t\tonReColor={this.handleReColor}\n\t\t\t\t\t\t\t\tonReTable={this.handleReTable}\n\t\t\t\t\t\t\t\tonClickCustom={this.toggleModalCustomCourse}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row className=\"mb-2\">\n\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t<CourseTable\n\t\t\t\t\t\t\ttableData={this.state.customTable}\n\t\t\t\t\t\t\tonDelSatOrSun={this.handleDelSatOrSun}\n\t\t\t\t\t\t\tonDelCourse={this.handleDelCourse}\n\t\t\t\t\t\t\tonEditCourse={this.handleOpenEditModal}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<hr />\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t<CourseList\n\t\t\t\t\t\t\tdeptList={this.state.deptList}\n\t\t\t\t\t\t\tcourseList={parsedCourseList}\n\t\t\t\t\t\t\tonChangeDept={this.changeDept}\n\t\t\t\t\t\t\tonAddCourse={this.checkConflict}\n\t\t\t\t\t\t\tfilterConflict={this.state.filterConflict}\n\t\t\t\t\t\t\tonFilterConflict={this.filterConflict}\n\t\t\t\t\t\t\tfilterCourse={isFilterCourse}\n\t\t\t\t\t\t\tonFilterCourse={this.toggleModalFilterCourse}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t\t<Modal id=\"ModalEditCourse\" isOpen={this.state.modalEditCourse.open} toggle={this.toggleModalEditCourse}>\n\t\t\t\t\t<ModalHeader id=\"ModalEditCourse__title\" toggle={this.toggleModalEditCourse}>{this.state.modalEditCourse.modalTitle}</ModalHeader>\n\t\t\t\t\t<ModalBody>\n\t\t\t\t\t\t<Form>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalEditCourse__inputTitle\" sm={2}>標題</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<Input type=\"text\" id=\"ModalEditCourse__inputTitle\" defaultValue={this.state.modalEditCourse.title} placeholder=\"課程名稱\" />\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalEditCourse__inputDesc\" sm={2}>內容</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<Input type=\"text\" id=\"ModalEditCourse__inputDesc\" defaultValue={this.state.modalEditCourse.desc} placeholder=\"教師、地點\" />\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalEditCourse__inputBg\" sm={2}>標記</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<input id=\"ModalEditCourse__inputBg\" type=\"color\" defaultValue={this.state.modalEditCourse.bg || '#ffffff'} style={{verticalAlign: 'sub', width: '100%'}}/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t</Form>\n\t\t\t\t\t</ModalBody>\n\t\t\t\t\t<ModalFooter>\n\t\t\t\t\t\t<Button color=\"primary\" onClick={() => {this.handleEditCourse(this.state.modalEditCourse.time, this.state.modalEditCourse.dayOfWeek)}}>確定</Button>\n\t\t\t\t\t</ModalFooter>\n\t\t\t\t</Modal>\n\t\t\t\t<Modal id=\"ModalCustomCourse\" isOpen={this.state.modalCustomCourseOpen} toggle={this.toggleModalCustomCourse}>\n\t\t\t\t\t<ModalHeader toggle={this.toggleModalCustomCourse}>自訂時段</ModalHeader>\n\t\t\t\t\t<ModalBody>\n\t\t\t\t\t\t<Form>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalCustomCourse__inputTime\" sm={2}>時間</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<Input type=\"text\" id=\"ModalCustomCourse__inputTime\" placeholder=\"2bcd4jk\" />\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalCustomCourse__inputTitle\" sm={2}>標題</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<Input type=\"text\" id=\"ModalCustomCourse__inputTitle\" placeholder=\"meeting\" />\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalCustomCourse__inputDesc\" sm={2}>內容</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<Input type=\"text\" id=\"ModalCustomCourse__inputDesc\" placeholder=\"R438 with YCC\" />\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalCustomCourse__inputBg\" sm={2}>標記</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<input id=\"ModalCustomCourse__inputBg\" type=\"color\" defaultValue=\"#ffffff\" style={{verticalAlign: 'sub', width: '100%'}}/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t</Form>\n\t\t\t\t\t</ModalBody>\n\t\t\t\t\t<ModalFooter>\n\t\t\t\t\t\t<Button color=\"primary\" onClick={this.handleAddCustomCourse}>確定</Button>\n\t\t\t\t\t</ModalFooter>\n\t\t\t\t</Modal>\n\t\t\t\t<Modal id=\"ModalFilterCourse\" isOpen={this.state.modalFilterCourseOpen} toggle={this.toggleModalFilterCourse}>\n\t\t\t\t\t<ModalHeader id=\"ModalFilterCourse__title\" toggle={this.toggleModalFilterCourse}>篩選課程</ModalHeader>\n\t\t\t\t\t<ModalBody>\n\t\t\t\t\t\t<Form>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalFilterCourse__inputCname\" sm={2}>課名</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tid=\"ModalFilterCourse__inputCname\"\n\t\t\t\t\t\t\t\t\t\tvalue={this.state.filterCourseForm.cname}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => { this.handleFilterCourseChange(e, 'cname') }}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"課程名稱\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalFilterCourse__inputTeacher\" sm={2}>教師</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tid=\"ModalFilterCourse__inputTeacher\"\n\t\t\t\t\t\t\t\t\t\tvalue={this.state.filterCourseForm.teacher}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => { this.handleFilterCourseChange(e, 'teacher') }}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"授課教師\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalFilterCourse__inputTime\" sm={2}>時間</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tid=\"ModalFilterCourse__inputTime\"\n\t\t\t\t\t\t\t\t\t\tvalue={this.state.filterCourseForm.time}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => { this.handleFilterCourseChange(e, 'time') }}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"1bcd\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t<Label for=\"ModalFilterCourse__inputLocation\" sm={2}>教室</Label>\n\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\tid=\"ModalFilterCourse__inputLocation\"\n\t\t\t\t\t\t\t\t\t\tvalue={this.state.filterCourseForm.location}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => { this.handleFilterCourseChange(e, 'location') }}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"管268\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t</Form>\n\t\t\t\t\t</ModalBody>\n\t\t\t\t\t<ModalFooter>\n\t\t\t\t\t\t<Button color=\"primary\" onClick={this.handleFilterCourse}>篩選</Button>\n\t\t\t\t\t\t<Button color=\"danger\" onClick={this.handleClearFilterCourse}>取消篩選</Button>\n\t\t\t\t\t</ModalFooter>\n\t\t\t\t</Modal>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nCourseTableContainer.contextTypes = {\n\tuser: PropTypes.object\n};\n","import React from 'react';\n\nimport App from './App.jsx';\nimport CourseTableContainer from './CourseTableContainer.jsx';\n\nexport default class Home extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<App>\n\t\t\t\t<CourseTableContainer />\n\t\t\t</App>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport {\n\tContainer,\n\tRow,\n\tCol,\n\tCard,\n\tLabel,\n\tInput,\n\tButton\n} from 'reactstrap';\nimport TagsInput from 'react-tagsinput';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nimport 'react-tagsinput/react-tagsinput.css';\nimport './ExchangeSetting.css';\n\nconst SettingContainer = styled(Container)`\n\tbackground: #fff;\n\tbox-shadow: 0 0 5px 0 #888888;\n\tposition: absolute;\n\twidth: 100%;\n\tz-index: 1;\n\tleft: 0;\n\ttop: ${(props) => props.top};\n\ttransition: all .5s;\n`;\n\nconst Toggle = styled.div`\n\tborder-top: 1px solid rgba(0,0,0,.125);\n\tbackground: #fafafa;\n\t&:hover {\n\t\tbackground: #f0f0f0;\n\t\tcursor: pointer;\n\t}\n`;\n\nexport default class ExchangeSetting extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\twantTags: [],\n\t\t\thaveTags: [],\n\t\t\tdesc: '',\n\t\t\tfilterTags: [],\n\t\t\tpublished: false,\n\t\t\tsettingOpen: true\n\t\t};\n\n\t\tthis.handleChangeWant = this.handleChangeWant.bind(this);\n\t\tthis.handleChangeHave = this.handleChangeHave.bind(this);\n\t\tthis.handleChangeDesc = this.handleChangeDesc.bind(this);\n\t\tthis.handleChangeFilter = this.handleChangeFilter.bind(this);\n\t\tthis.handleSave = this.handleSave.bind(this);\n\t\tthis.handleFilter = this.handleFilter.bind(this);\n\t\tthis.handleToggleSetting = this.handleToggleSetting.bind(this);\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tconst exchangeSetting = nextProps.exchangeList[this.context.user.uuid] ? JSON.parse(nextProps.exchangeList[this.context.user.uuid]) : null;\n\t\tif (exchangeSetting) {\n\t\t\tthis.setState({\n\t\t\t\twantTags: exchangeSetting.want,\n\t\t\t\thaveTags: exchangeSetting.have,\n\t\t\t\tdesc: exchangeSetting.desc,\n\t\t\t\tpublished: true\n\t\t\t})\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\twantTags: [],\n\t\t\t\thaveTags: [],\n\t\t\t\tdesc: '',\n\t\t\t\tpublished: false\n\t\t\t})\n\t\t}\n\t}\n\n\thandleChangeWant(wantTags) {\n\t\tthis.setState({\n\t\t\twantTags\n\t\t});\n\t}\n\n\thandleChangeHave(haveTags) {\n\t\tthis.setState({\n\t\t\thaveTags\n\t\t});\n\t}\n\n\thandleChangeDesc(e) {\n\t\tthis.setState({\n\t\t\tdesc: e.target.value\n\t\t});\n\t}\n\n\thandleChangeFilter(filterTags) {\n\t\tthis.setState({\n\t\t\tfilterTags\n\t\t});\n\t}\n\n\thandleSave() {\n\t\tif (!!this.state.haveTags.length || !!this.state.wantTags.length) {\n\t\t\tthis.props.onSave(this.state.haveTags, this.state.wantTags, this.state.desc);\n\t\t} else {\n\t\t\talert('請確保 Tag 有變成綠綠的 (於輸入框按下 Enter)');\n\t\t}\n\t}\n\n\thandleFilter(clear) {\n\t\tconst keywords = this.state.filterTags;\n\t\tif (clear || !keywords.length) {\n\t\t\tif (!clear && !keywords.length) {\n\t\t\t\talert('請確保 Tag 有變成綠綠的 (於輸入框按下 Enter)');\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\tfilterTags: []\n\t\t\t});\n\n\t\t\tthis.props.onFilter(null);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.props.onFilter(keywords);\n\t}\n\thandleToggleSetting() {\n\t\tthis.setState((prevState) => ({\n\t\t\tsettingOpen: !prevState.settingOpen\n\t\t}));\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<SettingContainer className=\"pt-3\" top={!this.state.settingOpen ? `-${document.getElementById('ExchangeSetting').offsetHeight + 32}px` : 0}>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t<div id=\"ExchangeSetting\">\n\t\t\t\t\t\t\t<h5>設定個人換課資訊</h5>\n\t\t\t\t\t\t\t<Card body>\n\t\t\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t\t\t<Col className=\"d-inline-block\" xs=\"4\">\n\t\t\t\t\t\t\t\t\t\t<Label for=\"ExchangeSetting__inputWant\">想要的課</Label>\n\t\t\t\t\t\t\t\t\t\t<TagsInput className=\"form-control\" id=\"ExchangeSetting__inputWant\" onlyUnique value={this.state.wantTags} onChange={this.handleChangeWant} />\n\t\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t\t<Col className=\"d-inline-block\" xs=\"4\">\n\t\t\t\t\t\t\t\t\t\t<Label for=\"ExchangeSetting__inputHave\">不需要的課</Label>\n\t\t\t\t\t\t\t\t\t\t<TagsInput className=\"form-control\" id=\"ExchangeSetting__inputHave\" onlyUnique value={this.state.haveTags} onChange={this.handleChangeHave} />\n\t\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t\t<Col className=\"d-inline-block\" xs=\"4\">\n\t\t\t\t\t\t\t\t\t\t<Label for=\"ExchangeSetting__inputDesc\">補充說明</Label>\n\t\t\t\t\t\t\t\t\t\t<Input type=\"textarea\" id=\"ExchangeSetting__inputDesc\" rows=\"1\" value={this.state.desc} onChange={this.handleChangeDesc} />\n\t\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t\t<Row className=\"mt-2\">\n\t\t\t\t\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t\t\t\t\t{ this.state.published &&\n\t\t\t\t\t\t\t\t\t\t\t<Button className=\"float-right\" size=\"sm\" color=\"danger\" onClick={() => {this.props.onUnpublish();}}>取消發佈</Button>\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t<Button className=\"float-right mr-2\" size=\"sm\" color=\"primary\" onClick={this.handleSave}>儲存並發佈</Button>\n\t\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t<h5>過濾換課資訊</h5>\n\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t<Col xs=\"9\">\n\t\t\t\t\t\t\t\t<TagsInput className=\"form-control\" id=\"Filter__input\" onlyUnique value={this.state.filterTags} onChange={this.handleChangeFilter} />\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t<Col className=\"text-center\" xs=\"3\">\n\t\t\t\t\t\t\t\t<Button size=\"sm\" outline color=\"primary\" style={{verticalAlign: 'sub'}} onClick={() => this.handleFilter(false)}>\n\t\t\t\t\t\t\t\t\t<i className=\"fa fa-filter\" aria-hidden=\"true\"></i> <span className=\"hidden-sm-down\">過濾</span>\n\t\t\t\t\t\t\t\t</Button>{' '}\n\t\t\t\t\t\t\t\t<Button size=\"sm\" outline color=\"secondary\" style={{verticalAlign: 'sub'}} onClick={() => this.handleFilter(true)}>\n\t\t\t\t\t\t\t\t<i className=\"fa fa-refresh\" aria-hidden=\"true\"></i> <span className=\"hidden-sm-down\">清除</span></Button>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t<Row className=\"mt-2\">\n\t\t\t\t\t\t\t<Col className=\"text-center\" xs=\"12\">\n\t\t\t\t\t\t\t\t<Toggle onClick={this.handleToggleSetting}>\n\t\t\t\t\t\t\t\t\t<i className=\"fa fa-bars\" aria-hidden=\"true\"></i>\n\t\t\t\t\t\t\t\t</Toggle>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</SettingContainer>\n\t\t);\n\t}\n}\n\nExchangeSetting.contextTypes = {\n\tuser: PropTypes.object\n};\n","import React from 'react';\nimport {\n\tRow,\n\tCol,\n\tCard,\n\tBadge\n} from 'reactstrap';\nimport moment from 'moment';\nimport styled from 'styled-components';\n\nconst Container = styled(Card)`\n\tpadding: 5px 5px 5px 30px;\n`;\n\nconst Profile = styled.img`\n\tborder-radius: 50px;\n`;\n\nconst Username = styled.a`\n\tcolor: #365899;\n\tfont-weight: bold\n`;\n\nconst Timestamp = styled.td`\n\tfont-size: 13px;\n\tcolor: #989898\n`;\n\nconst Desc = styled.div`\n\tfont-size: 14px;\n\tcolor: #666;\n\tborder-left: 3px solid #bbb;\n`;\n\nconst CourseTitle = styled.h6`\n\tborder-bottom: 1px solid #787878;\n`;\n\nconst Course = styled.div`\n\tfont-size: 14px;\n`;\n\nexport default class ExchangeItem extends React.PureComponent {\n\trender() {\n\t\tconst { item } = this.props;\n\t\treturn (\n\t\t\t<Container>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col className=\"mt-1\" lg=\"5\" sm=\"12\" xs=\"12\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td className=\"pr-1\" rowSpan=\"2\">\n\t\t\t\t\t\t\t\t\t\t\t<a href={ item.fbLink || `https://fb.com/${ item.fbid }` }>\n\t\t\t\t\t\t\t\t\t\t\t\t<Profile height=\"45px\" src={`https://graph.facebook.com/${item.fbid}/picture`} alt=\"\" />\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<Username href={ item.fbLink || `https://fb.com/${ item.fbid }` }>{item.name}</Username>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<Timestamp>\n\t\t\t\t\t\t\t\t\t\t\t{moment(item.time).utcOffset(8).format('YYYY/MM/DD HH:mm:ss')}\n\t\t\t\t\t\t\t\t\t\t</Timestamp>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Desc className=\"mt-1 ml-2 pl-1\">\n\t\t\t\t\t\t\t{item.desc.split('\\n').map((val, i) => {\n\t\t\t\t\t\t\t\treturn (<div key={i}>{val}</div>)\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</Desc>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col lg=\"4\" sm=\"12\" xs=\"12\">\n\t\t\t\t\t\t<CourseTitle className=\"pl-3\">想要的課</CourseTitle>\n\t\t\t\t\t\t{item.want.map((wnatCourse, i) => {\n\t\t\t\t\t\t\treturn (<Course key={i}><Badge color=\"secondary\" pill>{i + 1}</Badge> {wnatCourse}</Course>)\n\t\t\t\t\t\t})}\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col lg=\"3\" sm=\"12\" xs=\"12\">\n\t\t\t\t\t\t<CourseTitle className=\"pl-3\">不需要的課</CourseTitle>\n\t\t\t\t\t\t{item.have.map((haveCourse, i) => {\n\t\t\t\t\t\t\treturn (<Course key={i}><Badge color=\"secondary\" pill>{i + 1}</Badge> {haveCourse}</Course>)\n\t\t\t\t\t\t})}\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</Container>\n\t\t)\n\t}\n}\n","import React from 'react';\nimport {\n\tContainer,\n\tRow,\n\tCol\n} from 'reactstrap';\n\nimport ExchangeItem from './ExchangeItem';\n\nexport default class ExchangeList extends React.Component {\n\trender() {\n\t\tconst containerStyle = {\n\t\t\tmarginTop: '190px',\n\t\t\ttransition: 'all .5s'\n\t\t}\n\n\t\treturn (\n\t\t\t<Container className=\"mb-5\" style={containerStyle}>\n\t\t\t\t{ this.props.exchangeList.map((item, i) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Row key={i} className=\"mb-2\">\n\t\t\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t\t\t<ExchangeItem item={ item } />\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</Container>\n\t\t)\n\t}\n}\n","import React from 'react';\nimport {\n\tRow,\n\tCol,\n\tContainer,\n\tAlert\n} from 'reactstrap';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport cloenDeep from 'lodash.clonedeep';\nimport ReactAlert from 'react-s-alert';\n\nimport 'react-s-alert/dist/s-alert-default.css';\nimport 'react-s-alert/dist/s-alert-css-effects/genie.css';\n\nimport ExchangeSetting from './ExchangeSetting.jsx'\nimport ExchangeList from './ExchangeList.jsx'\nimport Loading from './Loading';\n\nexport default class ExchangeListContainer extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\texchangeList: {},\n\t\t\tfilter: null\n\t\t};\n\n\t\tthis.db = window.firebase.database();\n\t\tthis.handleSaveExchangeSetting = this.handleSaveExchangeSetting.bind(this);\n\t\tthis.handleUnpublish = this.handleUnpublish.bind(this);\n\t\tthis.handleFilter = this.handleFilter.bind(this);\n\t\tthis.parseList = this.parseList.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.getExchangeList();\n\t}\n\n\tgetExchangeList() {\n\t\tthis.db.ref('exchangeList/').once('value').then((snapshot) => {\n\t\t\tconst data = snapshot.val() || {};\n\t\t\tthis.setState({\n\t\t\t\texchangeList: data\n\t\t\t});\n\n\t\t\t// show alert\n\t\t\t// FIXME: 好像不需要這個 alert 了\n\t\t\t// if (!window.localStorage['@KeBiau:exchangeAlert'] || !JSON.parse(window.localStorage['@KeBiau:exchangeAlert'])) {\n\t\t\t// \tReactAlert.warning('請注意：<br />退選成功的名額可能不會立即釋出', {\n\t\t\t// \t\tposition: 'bottom-right',\n\t\t\t// \t\teffect: 'genie',\n\t\t\t// \t\tbeep: false,\n\t\t\t// \t\ttimeout: 'none',\n\t\t\t// \t\tonClose: () => {\n\t\t\t// \t\t\twindow.localStorage['@KeBiau:exchangeAlert'] = JSON.stringify(true);\n\t\t\t// \t\t}\n\t\t\t// \t});\n\t\t\t// }\n\n\t\t\t// FIXME: 拿不到 fb userlink (userLink & fbLink)\n\t\t\tif (!window.localStorage['@KeBiau:wtfFBuserlink'] || !JSON.parse(window.localStorage['@KeBiau:wtfFBuserlink'])) {\n\t\t\t\tReactAlert.warning('FB 帳號連結目前有問題，請見諒', {\n\t\t\t\t\tposition: 'bottom-right',\n\t\t\t\t\teffect: 'genie',\n\t\t\t\t\tbeep: false,\n\t\t\t\t\ttimeout: 'none',\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\twindow.localStorage['@KeBiau:wtfFBuserlink'] = JSON.stringify(true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSaveExchangeSetting(have, want, desc) {\n\t\tconst name = this.context.user.displayName;\n\t\tconst fbid = this.context.user.uid;\n\t\tconst fbLink = this.context.user.fbLink || null;\n\t\tconst uuid = this.context.user.uuid;\n\t\tconst time = moment().format();\n\t\tthis.db.ref(`exchangeList/${uuid}`).set(JSON.stringify({\n\t\t\tfbid, fbLink, name, want, have, desc, time\n\t\t}))\n\t\t.then(() => {\n\t\t\tthis.getExchangeList();\n\t\t});\n\t}\n\n\thandleUnpublish() {\n\t\tthis.db.ref(`exchangeList/${this.context.user.uuid}`).remove().then(() => {\n\t\t\tthis.getExchangeList();\n\t\t});\n\t}\n\n\thandleFilter(keywords) {\n\t\tthis.setState({\n\t\t\tfilter: keywords\n\t\t});\n\t}\n\n\tparseList() {\n\t\tconst exchangeList = cloenDeep(this.state.exchangeList);\n\t\tconst filterArr = this.state.filter ? cloenDeep(this.state.filter) : null;\n\n\t\tlet result = Object.values(exchangeList).map((val) => {\n\t\t\treturn JSON.parse(val);\n\t\t});\n\n\t\tresult = this.shuffle(result);\n\t\tif (filterArr) {\n\t\t\tresult = result.filter((val) => {\n\t\t\t\tlet valid = false;\n\t\t\t\tlet testString = val.have.join('') + val.want.join('');\n\t\t\t\tfilterArr.forEach((keyword) => {\n\t\t\t\t\tif (testString.includes(keyword)) {\n\t\t\t\t\t\tvalid = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn valid;\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tshuffle(array) {\n\t\tvar currentIndex = array.length, temporaryValue, randomIndex;\n\n\t\t// While there remain elements to shuffle...\n\t\twhile (0 !== currentIndex) {\n\n\t\t\t// Pick a remaining element...\n\t\t\trandomIndex = Math.floor(Math.random() * currentIndex);\n\t\t\tcurrentIndex -= 1;\n\n\t\t\t// And swap it with the current element.\n\t\t\ttemporaryValue = array[currentIndex];\n\t\t\tarray[currentIndex] = array[randomIndex];\n\t\t\tarray[randomIndex] = temporaryValue;\n\t\t}\n\n\t\treturn array;\n\t}\n\n\trender() {\n\t\tconst containerStyle = {\n\t\t\theight: 'calc(100vh - 52px)',\n\t\t\toverflow: 'auto',\n\t\t\tbackground: '#fff'\n\t\t};\n\n\t\tconst exchangeList = this.parseList();\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{ this.context.user && !this.context.user.uid &&\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t\t<Alert className=\"text-center mt-3\" color=\"danger\">請先登入</Alert>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t}\n\n\t\t\t\t{ this.context.user && this.context.user.uid &&\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<ExchangeSetting\n\t\t\t\t\t\t\texchangeList={this.state.exchangeList}\n\t\t\t\t\t\t\tonSave={this.handleSaveExchangeSetting}\n\t\t\t\t\t\t\tonUnpublish={this.handleUnpublish}\n\t\t\t\t\t\t\tonToggleSetting={this.handleToggleSetting}\n\t\t\t\t\t\t\tonFilter={this.handleFilter}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Container style={containerStyle}>\n\t\t\t\t\t\t\t{ !exchangeList.length &&\n\t\t\t\t\t\t\t\t<Loading marginTop={ 450 } />\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t\t\t\t<ExchangeList exchangeList={exchangeList}/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t</Container>\n\t\t\t\t\t\t<ReactAlert html />\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nExchangeListContainer.contextTypes = {\n\tuser: PropTypes.object\n};\n","import React from 'react';\n\nimport App from './App.jsx';\nimport ExchangeListContainer from './ExchangeListContainer.jsx';\n\nexport default class Exchange extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<App {...this.props}>\n\t\t\t\t<ExchangeListContainer />\n\t\t\t</App>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { \n\tRow,\n\tCol,\n\tAlert\n} from 'reactstrap';\nimport styled from 'styled-components';\n\nimport App from './App.jsx';\nimport CourseTable from './CourseTable.jsx';\n\nconst ShareContainer = styled.div`\n\tbackground: #fff;\n\tpadding: 20px 5px;\n\tbox-shadow: 0 0 10px 0 #080808;\n\tmargin-top: 55px;\n\tmargin-bottom: 55px;\n`;\n\nexport default class Share extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tcustomTable: 'Loading...'\n\t\t}\n\n\t\tthis.db = window.firebase.database();\n\t}\n\n\tcomponentDidMount() {\n\t\tconst routeHash = this.context.router.route.match.params.hash;\n\t\tconst uuid = routeHash.substring(0, routeHash.length - 4);\n\t\tconst hash = routeHash.substring(routeHash.length - 4, routeHash.length);\n\t\tthis.db.ref(`sharedTable/${uuid}`).once('value').then((snapshot) => {\n\t\t\tconst data = snapshot.val();\n\t\t\tif (data === null) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tcustomTable: '連結無效'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst tableData = JSON.parse(data)[hash];\n\t\t\tif (!tableData) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tcustomTable: '連結無效'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\tcustomTable: tableData\n\t\t\t});\n\t\t});\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<App>\n\t\t\t\t<ShareContainer>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t\t{ typeof this.state.customTable === 'string' &&\n\t\t\t\t\t\t\t\t<Alert className=\"text-center\" color=\"warning\">{this.state.customTable}</Alert>\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t{ typeof this.state.customTable !== 'string' &&\n\t\t\t\t\t\t\t\t<CourseTable tableData={this.state.customTable} shared />\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</ShareContainer>\n\t\t\t</App>\n\t\t)\n\t}\n}\n\nShare.contextTypes = {\n\trouter: PropTypes.object\n}\n","import React from 'react';\nimport TagsInput from 'react-tagsinput';\nimport {\n\tButtonGroup,\n\tButton\n} from 'reactstrap';\n\nimport './CourseReviewFilter.css';\n\nexport default class CourseReviewFilter extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"mt-2\">\n\t\t\t\t<h5>搜尋課程</h5>\n\t\t\t\t<TagsInput \n\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\tid=\"ExchangeSetting__inputWant\"\n\t\t\t\t\tvalue={this.props.filterTags}\n\t\t\t\t\tonChange={this.props.onFilter}\n\t\t\t\t\tonlyUnique\n\t\t\t\t/>\n\t\t\t\t<div className=\"mt-2\">\n\t\t\t\t\t<ButtonGroup size=\"sm\">\n\t\t\t\t\t\t<Button className={this.props.sortType === 1 ? 'active' : ''} onClick={() => this.props.onChangeSortType(1)}>時間優先</Button>{' '}\n\t\t\t\t\t\t<Button className={this.props.sortType === 2 ? 'active' : ''} onClick={() => this.props.onChangeSortType(2)}>評價優先</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport {\n\tCard,\n\tCardBody,\n\tCardColumns\n} from 'reactstrap';\nimport moment from 'moment';\nimport styled, { css } from 'styled-components';\n\nimport './CourseReviewList.css';\n\nconst ReviewCard = styled(Card)`\n\tborder-radius: 0;\n\tbox-shadow: 0 0 5px 0px #dddddd;\n`;\n\nReviewCard.DelBtn = styled.span`\n\tposition: absolute;\n\tright: 15px;\n\tfont-size: 26px;\n\ttop: 12px;\n\tcursor: pointer;\n\theight: 17px;\n\tline-height: 17px;\n\tcolor: #d9534f;\n\t&:hover {\n\t\tcolor: #c9302c;\n\t}\n`;\n\nReviewCard.UserImg = styled.img`\n\tborder-radius: 30px;\n`;\n\nReviewCard.Username = styled.span`\n\tcolor: #365899;\n\tfont-size: 14px;\n\tfont-weight: bold;\n`;\n\nReviewCard.Date = styled.span`\n\tfont-size: 12px;\n\tcolor: #90949c;\n`;\n\nReviewCard.Title = styled.div`\n\tfont-weight: bold;\n`;\n\nReviewCard.Content = styled.div`\n\twhite-space: pre-line;\n`;\n\nReviewCard.LikeBtn = styled.span`\n\tflex: 1;\n\tpadding: 7px;\n\ttransition: all .3s;\n\t${ props => props.like && css`\n\t\tcolor: #0275d8;\n\t\tfont-weight: bold;\n\t`}\n\n\t&:hover {\n\t\tbackground: #0275d8;\n\t\tcolor: #fff;\n\t\tcursor: pointer;\n\t}\n`;\n\nReviewCard.DisLikeBtn = styled.span`\n\tflex: 1;\n\tpadding: 7px;\n\ttransition: all .3s;\n\t${ props => props.dislike && css`\n\t\tcolor: #d9534f;\n\t\tfont-weight: bold;\n\t`}\n\n\t&:hover {\n\t\tbackground: #d9534f;\n\t\tcolor: #fff;\n\t\tcursor: pointer;\n\t}\n`\n\nclass ReviewItem extends React.Component {\n\trender() {\n\t\tconst data = this.props.data;\n\t\tconst like = +data.currentUserLike === 1;\n\t\tconst dislike = +data.currentUserLike === -1; \n\t\treturn (\n\t\t\t<ReviewCard className=\"mb-2\">\n\t\t\t\t<CardBody className=\"pb-2\">\n\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td className=\"pr-2\" rowSpan=\"2\">\n\t\t\t\t\t\t\t\t\t\t<a href={ data.fbLink || `https://fb.com/${ data.fbid }` }>\n\t\t\t\t\t\t\t\t\t\t\t<ReviewCard.UserImg src={`https://graph.facebook.com/${data.fbid}/picture`} height=\"55\" alt=\"\"/>\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<a href={ data.fbLink || `https://fb.com/${ data.fbid }` }>\n\t\t\t\t\t\t\t\t\t\t\t<ReviewCard.Username>{data.username}</ReviewCard.Username>\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t{ !!data.currentUserPost &&\n\t\t\t\t\t\t\t\t\t\t\t<ReviewCard.DelBtn onClick={() => {this.props.onDel(data.key)}}>&times;</ReviewCard.DelBtn>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<ReviewCard.Date>{moment(data.time).utcOffset(8).format('YYYY/MM/DD HH:mm:ss')}</ReviewCard.Date>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<ReviewCard.Title>\n\t\t\t\t\t\t\t{ data.cid ? `${data.cid} ` : '' }\n\t\t\t\t\t\t\t{ data.cname }\n\t\t\t\t\t\t\t{ data.teacher ? ` | ${data.teacher}` : ''}\n\t\t\t\t\t\t</ReviewCard.Title>\n\t\t\t\t\t\t<ReviewCard.Content>\n\t\t\t\t\t\t\t{ data.content }\n\t\t\t\t\t\t</ReviewCard.Content>\n\t\t\t\t\t</div>\n\t\t\t\t\t<hr style={{marginBottom: '5px'}} />\n\t\t\t\t\t<div style={{display: 'flex'}}>\n\t\t\t\t\t\t<ReviewCard.LikeBtn className=\"text-center\" like={ !!like } onClick={() => {this.props.onLike(1, data.currentUserLike, data.key)}}>\n\t\t\t\t\t\t\t<i className={`fa ${!!like ? 'fa-thumbs-up' : 'fa-thumbs-o-up'}`} aria-hidden=\"true\"></i> {data.like['1'] || 0 }\n\t\t\t\t\t\t</ReviewCard.LikeBtn>\n\t\t\t\t\t\t<ReviewCard.DisLikeBtn className=\"text-center\" dislike={ !!dislike } onClick={() => {this.props.onLike(-1, data.currentUserLike, data.key)}}>\n\t\t\t\t\t\t\t<i className={`fa ${!!dislike ? 'fa-thumbs-down' : 'fa-thumbs-o-down'}`} aria-hidden=\"true\"></i> {data.like['-1'] || 0 }\n\t\t\t\t\t\t</ReviewCard.DisLikeBtn>\n\t\t\t\t\t</div>\n\t\t\t\t</CardBody>\n\t\t\t</ReviewCard>\n\t\t);\n\t}\n}\n\nexport default class CourseReviewList extends React.Component {\n\tcomponentWillReceiveProps() {\n\t\t!!window.reviewListBricks && window.reviewListBricks.destroy();\n\t}\n\n\tcomponentDidUpdate() {\n\t\twindow.reviewListBricks = new window.Bricklayer(document.querySelector('.bricklayer'));\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<CardColumns className=\"mb-3 bricklayer\">\n\t\t\t\t{ this.props.reviewList.map((data, i) => {\n\t\t\t\t\treturn <ReviewItem key={i} data={data} {...this.props} />\t\n\t\t\t\t})}\n\t\t\t</CardColumns>\n\t\t)\n\t}\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {\n\tContainer,\n\tRow,\n\tCol,\n\tAlert,\n\tModal,\n\tModalHeader,\n\tModalBody,\n\tModalFooter,\n\tFormGroup,\n\tLabel,\n\tInput,\n\tButton\n} from 'reactstrap';\nimport moment from 'moment';\nimport cloneDeep from 'lodash.clonedeep';\nimport styled from 'styled-components';\n\nimport CourseReviewFilter from './CourseReviewFilter.jsx';\nimport CourseReviewList from './CourseReviewList.jsx';\n\nconst RelativeContainer = styled(Container)`\n\tbackground: #fff;\n\tposition: relative;\n`;\n\nconst ThePen = styled.div`\n\tbackground: #db4437;\n\tcolor: #fff;\n\tpadding: 10px 15px 0px 15px;\n\tposition: absolute;\n\tright: 10px;\n\tbottom: 10px;\n\twidth: 52px;\n\theight: 52px;\n\tborder-radius: 30px;\n\toverflow: hidden;\n\tcursor: pointer;\n\tbox-shadow: 1px 1px 5px 1px #bbbbbb;\n\ttransition: all .3s;\n\t&:hover {\n\t\twidth: 180px;\n\t\tbox-shadow: 1px 1px 5px 1px #787878;\n\t}\n\n\ti.fa {\n\t\tpadding-bottom: 15px;\n\t\tfont-size: 30px;\n\t\tmargin-right: 10px;\n\t}\n`;\n\nconst ReviewListContainer = styled(Row)`\n\toverflow: auto;\n\theight: calc(100vh - 202px);\n`;\n\nexport default class CourseReviewContainer extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\taddReviewModalOpen: false,\n\t\t\treviewData: {},\n\t\t\tlikeData: {},\n\t\t\tsortType: 1,\n\t\t\tfilterTags: []\n\t\t}\n\n\t\tthis.db = window.firebase.database();\n\t\tthis.toggleAddReviewModal = this.toggleAddReviewModal.bind(this);\n\t\tthis.handleAddReview = this.handleAddReview.bind(this);\n\t\tthis.getReviewList = this.getReviewList.bind(this);\n\t\tthis.parseReviewList = this.parseReviewList.bind(this);\n\t\tthis.handleFilter = this.handleFilter.bind(this);\n\t\tthis.handleChangeSortType = this.handleChangeSortType.bind(this);\n\t\tthis.handleDelReview = this.handleDelReview.bind(this);\n\t\tthis.handleLike = this.handleLike.bind(this);\n\n\t\tthis.getReviewList();\n\t}\n\n\tgetReviewList() {\n\t\tlet reviewData;\n\t\tlet likeData;\n\t\tthis.db.ref('review').once('value').then((snapshot) => {\n\t\t\treviewData = snapshot.val() || {};\n\t\t})\n\t\t.then(() => {\n\t\t\tthis.db.ref('likedReview').once('value').then((snapshot) => {\n\t\t\t\tlikeData = snapshot.val() || {};\n\t\t\t\tthis.setState({\n\t\t\t\t\treviewData,\n\t\t\t\t\tlikeData\n\t\t\t\t})\n\t\t\t});\n\t\t});\n\t}\n\n\tparseReviewList() {\n\t\tconst reviewData = cloneDeep(this.state.reviewData);\n\t\tconst likeData = cloneDeep(this.state.likeData);\n\t\tconst uuid = this.context.user && this.context.user.uuid;\n\t\tlet result = [];\n\t\tlet likedCount = {};\n\t\tObject.values(likeData).forEach((likeObj, i) => {\n\t\t\tObject.keys(likeObj).forEach((reviewKey, j) => {\n\t\t\t\tif (!likedCount[reviewKey]) likedCount[reviewKey] = {};\n\t\t\t\tif (!likedCount[reviewKey][likeObj[reviewKey]]) likedCount[reviewKey][likeObj[reviewKey]] = 0\n\t\t\t\tlikedCount[reviewKey][likeObj[reviewKey]] ++;\n\t\t\t});\n\t\t});\n\n\t\tfor (let uid in reviewData) {\n\t\t\tfor (let reviewKey in reviewData[uid]) {\n\t\t\t\tlet reviewObj = JSON.parse(reviewData[uid][reviewKey]);\n\t\t\t\t// filter\n\t\t\t\tlet match = false;\n\t\t\t\tif (this.state.filterTags.length > 0) {\n\t\t\t\t\tthis.state.filterTags.some((keyword, i) => {\n\t\t\t\t\t\tkeyword = keyword.toLowerCase();\n\t\t\t\t\t\tif (reviewObj.cid.toLowerCase().includes(keyword) ||\n\t\t\t\t\t\t\treviewObj.cname.toLowerCase().includes(keyword) ||\n\t\t\t\t\t\t\treviewObj.teacher.toLowerCase().includes(keyword) ||\n\t\t\t\t\t\t\treviewObj.content.toLowerCase().includes(keyword)) {\n\t\t\t\t\t\t\tmatch = true;\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tmatch = true;\n\t\t\t\t}\n\n\t\t\t\t// like or dislike\n\t\t\t\tif (uuid &&\n\t\t\t\t\tlikeData[uuid] &&\n\t\t\t\t\tlikeData[uuid][reviewKey] !== undefined) {\n\t\t\t\t\treviewObj.currentUserLike = likeData[uuid][reviewKey]\n\t\t\t\t}\n\n\t\t\t\t// current user's post\n\t\t\t\tif (uuid &&\n\t\t\t\t\tuid === uuid) {\n\t\t\t\t\treviewObj.currentUserPost = true;\n\t\t\t\t}\n\n\t\t\t\t!!match && result.push({\n\t\t\t\t\t...reviewObj,\n\t\t\t\t\tkey: reviewKey,\n\t\t\t\t\tlike: likedCount[reviewKey] || {}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (this.state.sortType === 1) {\n\t\t\tresult.sort(this.compareByTime);\n\t\t} else {\n\t\t\tresult.sort(this.compareByLike);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tcompareByTime(a, b) {\n\t\tif (moment(a.time).isBefore(moment(b.time)))\n\t\t\treturn 1;\n\t\tif (moment(a.time).isBefore(moment(b.time)))\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\n\tcompareByLike(a, b) {\n\t\tif ((a.like['1'] || 0) < (b.like['1'] || 0))\n\t\t\treturn 1;\n\t\tif ((a.like['1'] || 0) > (b.like['1'] || 0))\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\n\ttoggleAddReviewModal() {\n\t\tthis.setState((prevState) => ({\n\t\t\taddReviewModalOpen: !prevState.addReviewModalOpen\n\t\t}));\n\t}\n\n\thandleAddReview() {\n\t\tconst cname = document.getElementById('ModalAddReview__inputCname').value;\n\t\tconst cid = document.getElementById('ModalAddReview__inputCid').value;\n\t\tconst teacher = document.getElementById('ModalAddReview__inputTeacher').value;\n\t\tconst content = document.getElementById('ModalAddReview__inputContent').value;\n\t\tif (cname === '' || content === '') {\n\t\t\talert('課程名稱、評論不得為空');\n\t\t\treturn;\n\t\t}\n\n\t\tconst uid = this.context.user.uuid;\n\t\tconst fbid = this.context.user.uid;\n\t\tconst fbLink = this.context.user.fbLink || null;\n\t\tconst username = this.context.user.displayName;\n\t\tconst time = moment().format();\n\t\tconst randomKey = (Date.now().toString(32) + Math.random().toString(32)).replace('.', '');\n\t\tthis.db.ref(`review/${uid}/${randomKey}`).set(JSON.stringify({\n\t\t\tcname, cid, teacher, content, fbid, fbLink, username, time\n\t\t}))\n\t\t.then(() => {\n\t\t\tthis.toggleAddReviewModal();\n\t\t\tthis.getReviewList();\n\t\t});\n\t}\n\n\thandleFilter(filterTags) {\n\t\tthis.setState({\n\t\t\tfilterTags\n\t\t});\n\t}\n\n\thandleChangeSortType(sortType) {\n\t\tthis.setState({\n\t\t\tsortType\n\t\t});\n\t}\n\n\thandleDelReview(key) {\n\t\tif (window.confirm('確定刪除此篇評論？')) {\n\t\t\tthis.db.ref(`review/${this.context.user.uuid}/${key}`).remove().then(() => {\n\t\t\t\tthis.getReviewList();\n\t\t\t});\n\t\t}\n\t}\n\n\thandleLike(btnType, currentUserLike, key) {\n\t\tif (btnType === currentUserLike) {\n\t\t\tthis.db.ref(`likedReview/${this.context.user.uuid}/${key}`).remove().then(() => {\n\t\t\t\tthis.getReviewList();\n\t\t\t});\n\t\t} else {\n\t\t\tthis.db.ref(`likedReview/${this.context.user.uuid}/${key}`).set(btnType).then(() => {\n\t\t\t\tthis.getReviewList();\n\t\t\t});\n\t\t}\n\t}\n\n\trender() {\n\t\tconst reviewList = this.parseReviewList();\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{ this.context.user && !this.context.user.uid &&\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t\t<Alert className=\"text-center mt-3\" color=\"danger\">請先登入</Alert>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t}\n\n\t\t\t\t{ this.context.user && this.context.user.uid &&\n\t\t\t\t\t<RelativeContainer>\n\t\t\t\t\t\t<Row id=\"CourseReviewFilter__wrapper\">\n\t\t\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t\t\t<CourseReviewFilter\n\t\t\t\t\t\t\t\t\tfilterTags={this.state.filterTags}\n\t\t\t\t\t\t\t\t\tonFilter={this.handleFilter}\n\t\t\t\t\t\t\t\t\tsortType={this.state.sortType}\n\t\t\t\t\t\t\t\t\tonChangeSortType={this.handleChangeSortType}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t<hr />\n\t\t\t\t\t\t<ReviewListContainer>\n\t\t\t\t\t\t\t<Col xs=\"12\">\n\t\t\t\t\t\t\t\t<CourseReviewList\n\t\t\t\t\t\t\t\t\treviewList={reviewList}\n\t\t\t\t\t\t\t\t\tonDel={this.handleDelReview}\n\t\t\t\t\t\t\t\t\tonLike={this.handleLike}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t</ReviewListContainer>\n\t\t\t\t\t\t<ThePen onClick={this.toggleAddReviewModal}>\n\t\t\t\t\t\t\t<i className=\"fa fa-pencil\" aria-hidden=\"true\"></i>留下一則評論...\n\t\t\t\t\t\t</ThePen>\n\t\t\t\t\t\t<Modal size=\"lg\" isOpen={this.state.addReviewModalOpen} toggle={this.toggleAddReviewModal}>\n\t\t\t\t\t\t\t<ModalHeader toggle={this.toggleAddReviewModal}>留下一則評論</ModalHeader>\n\t\t\t\t\t\t\t<ModalBody>\n\t\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t\t<Label className=\"text-danger\" for=\"ModalAddReview__inputCname\" sm={2}>課程名稱*</Label>\n\t\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t\t<Input type=\"text\" id=\"ModalAddReview__inputCname\" />\n\t\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t\t<Label for=\"ModalAddReview__inputCid\" sm={2}>課號</Label>\n\t\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t\t<Input type=\"text\" id=\"ModalAddReview__inputCid\" />\n\t\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t\t<Label for=\"ModalAddReview__inputTeacher\" sm={2}>教師</Label>\n\t\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t\t<Input type=\"text\" id=\"ModalAddReview__inputTeacher\" />\n\t\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t\t<FormGroup row>\n\t\t\t\t\t\t\t\t\t<Label className=\"text-danger\" for=\"ModalAddReview__inputContent\" sm={2}>評論*</Label>\n\t\t\t\t\t\t\t\t\t<Col sm={10}>\n\t\t\t\t\t\t\t\t\t\t<Input type=\"textarea\" name=\"text\" rows=\"5\" id=\"ModalAddReview__inputContent\" />\n\t\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t\t</FormGroup>\n\t\t\t\t\t\t\t</ModalBody>\n\t\t\t\t\t\t\t<ModalFooter>\n\t\t\t\t\t\t\t\t<Button color=\"primary\" block onClick={this.handleAddReview}>送出</Button>\n\t\t\t\t\t\t\t</ModalFooter>\n\t\t\t\t\t\t</Modal>\n\t\t\t\t\t</RelativeContainer>\n\t\t\t\t}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nCourseReviewContainer.contextTypes = {\n\tuser: PropTypes.object\n}\n","import React from 'react';\n\nimport App from './App.jsx';\nimport CourseReviewContainer from './CourseReviewContainer.jsx';\n\nexport default class CourseReview extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<App {...this.props}>\n\t\t\t\t<CourseReviewContainer />\n\t\t\t</App>\n\t\t)\n\t}\n}\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (!isLocalhost) {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      } else {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport {\n\tHashRouter as Router,\n\tRoute,\n\tRedirect,\n\tSwitch,\n} from 'react-router-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport Home from './Home.jsx';\nimport Exchange from './Exchange.jsx';\nimport Share from './Share.jsx';\nimport CourseReview from './CourseReview.jsx';\n\nimport registerServiceWorker from './registerServiceWorker';\n\n// Initialize Firebase\nconst config = {\n\tapiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n\tauthDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n\tdatabaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\n\tprojectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n\tstorageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n\tmessagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID\n};\nwindow.firebase.initializeApp(config);\n\nReactDOM.render(\n\t<Router>\n\t\t<Switch>\n\t\t\t<Route exact path=\"/\" component={Home} />\n\t\t\t<Route path=\"/exchange\" component={Exchange} />\n\t\t\t<Route exact path=\"/share/:hash\" component={Share} />\n\t\t\t<Route path=\"/review\" component={CourseReview} />\n\t\t\t<Redirect from=\"*\" to=\"/\" />\n\t\t</Switch>\n\t</Router>,\n\tdocument.getElementById('app')\n);\nregisterServiceWorker();\n"],"sourceRoot":""}